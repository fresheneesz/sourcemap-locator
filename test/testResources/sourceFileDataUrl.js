var someJavascript = {

}

//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyJGOlxcYmlsbHlzRmlsZVxcY29kZVxcamF2YXNjcmlwdFxcbm9kZWpzXFxkZWFkdW5pdENvcmVcXG5vZGVfbW9kdWxlc1xcYnVpbGQtbW9kdWxlc1xcbm9kZV9tb2R1bGVzXFxicm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJyb3dzZXItcGFja1xcX3ByZWx1ZGUuanMiLCJGOi9iaWxseXNGaWxlL2NvZGUvamF2YXNjcmlwdC9ub2RlanMvZGVhZHVuaXRDb3JlL25vZGVfbW9kdWxlcy9hc3luYy1mdXR1cmUvYXN5bmNGdXR1cmUuanMiLCJGOi9iaWxseXNGaWxlL2NvZGUvamF2YXNjcmlwdC9ub2RlanMvZGVhZHVuaXRDb3JlL25vZGVfbW9kdWxlcy9hc3luYy1mdXR1cmUvbm9kZV9tb2R1bGVzL3RyaW1Bcmd1bWVudHMvdHJpbUFyZ3VtZW50cy5qcyIsIkY6L2JpbGx5c0ZpbGUvY29kZS9qYXZhc2NyaXB0L25vZGVqcy9kZWFkdW5pdENvcmUvbm9kZV9tb2R1bGVzL2J1aWxkLW1vZHVsZXMvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2luaGVyaXRzL2luaGVyaXRzX2Jyb3dzZXIuanMiLCJGOi9iaWxseXNGaWxlL2NvZGUvamF2YXNjcmlwdC9ub2RlanMvZGVhZHVuaXRDb3JlL25vZGVfbW9kdWxlcy9idWlsZC1tb2R1bGVzL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9pbnNlcnQtbW9kdWxlLWdsb2JhbHMvbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsIkY6L2JpbGx5c0ZpbGUvY29kZS9qYXZhc2NyaXB0L25vZGVqcy9kZWFkdW5pdENvcmUvbm9kZV9tb2R1bGVzL2J1aWxkLW1vZHVsZXMvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL3V0aWwvc3VwcG9ydC9pc0J1ZmZlckJyb3dzZXIuanMiLCJGOi9iaWxseXNGaWxlL2NvZGUvamF2YXNjcmlwdC9ub2RlanMvZGVhZHVuaXRDb3JlL25vZGVfbW9kdWxlcy9idWlsZC1tb2R1bGVzL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy91dGlsL3V0aWwuanMiLCJGOi9iaWxseXNGaWxlL2NvZGUvamF2YXNjcmlwdC9ub2RlanMvZGVhZHVuaXRDb3JlL3Rlc3QvZGVhZHVuaXRUZXN0cy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1a0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpfXZhciBmPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChmLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGYsZi5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKiBDb3B5cmlnaHQgKGMpIDIwMTMgQmlsbHkgVGV0cnVkIC0gRnJlZSB0byB1c2UgZm9yIGFueSBwdXJwb3NlOiBNSVQgTGljZW5zZSovXHJcblxyXG52YXIgdHJpbUFyZ3MgPSByZXF1aXJlKFwidHJpbUFyZ3VtZW50c1wiKVxyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRnV0dXJlXHJcblxyXG5GdXR1cmUuZGVidWcgPSBmYWxzZSAvLyBzd2l0Y2ggdGhpcyB0byB0cnVlIGlmIHlvdSB3YW50IGlkcyBhbmQgbG9uZyBzdGFjayB0cmFjZXNcclxuXHJcbnZhciBjdXJJZCA9IDAgICAgICAgICAvLyBmb3IgaWRzXFxcclxuZnVuY3Rpb24gRnV0dXJlKHZhbHVlKSB7XHJcblx0aWYoYXJndW1lbnRzLmxlbmd0aCA+IDApIHtcclxuXHRcdHZhciBmID0gbmV3IEZ1dHVyZSgpXHJcbiAgICAgICAgZi5yZXR1cm4odmFsdWUpXHJcbiAgICAgICAgcmV0dXJuIGZcclxuXHR9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuaXNSZXNvbHZlZCA9IGZhbHNlXHJcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdXHJcbiAgICAgICAgaWYoRnV0dXJlLmRlYnVnKSB7XHJcbiAgICAgICAgICAgIGN1cklkKytcclxuICAgICAgICAgICAgdGhpcy5pZCA9IGN1cklkXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vLyBzdGF0aWMgbWV0aG9kc1xyXG5cclxuLy8gaGFzIG9uZSBwYXJhbWV0ZXI6IGVpdGhlciBhIGJ1bmNoIG9mIGZ1dHVyZXMsIG9yIGEgc2luZ2xlIGFycmF5IG9mIGZ1dHVyZXNcclxuLy8gcmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIG9uZSBvZiB0aGVtIGVycm9ycywgb3Igd2hlbiBhbGwgb2YgdGhlbSBzdWNjZWVkc1xyXG5GdXR1cmUuYWxsID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZihhcmd1bWVudHNbMF0gaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgIHZhciBmdXR1cmVzID0gYXJndW1lbnRzWzBdXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciBmdXR1cmVzID0gdHJpbUFyZ3MoYXJndW1lbnRzKVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBmID0gbmV3IEZ1dHVyZSgpXHJcbiAgICB2YXIgcmVzdWx0cyA9IFtdXHJcblxyXG4gICAgaWYoZnV0dXJlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnQgPSBmdXR1cmVzWzBdXHJcbiAgICAgICAgZnV0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKGZ1dHVyZSwgaW5kZXgpIHtcclxuICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQudGhlbihmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRzW2luZGV4XSA9IHZcclxuICAgICAgICAgICAgICAgIHJldHVybiBmdXR1cmVzW2luZGV4KzFdXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy9pZlxyXG4gICAgICAgIGN1cnJlbnQuY2F0Y2goZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBmLnRocm93KGUpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBlbHNlXHJcbiAgICAgICAgY3VycmVudC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBmLnJldHVybihyZXN1bHRzKVxyXG4gICAgICAgIH0pXHJcblxyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZi5yZXR1cm4ocmVzdWx0cylcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZlxyXG59XHJcblxyXG4vLyBlaXRoZXIgdXNlZCBsaWtlIGZ1dHVyZVdyYXAoZnVuY3Rpb24oKXsgLi4uIH0pKGFyZzEsYXJnMixldGMpIG9yXHJcbi8vICBmdXR1cmVXcmFwKG9iamVjdCwgJ21ldGhvZE5hbWUnKShhcmcxLGFyZzIsZXRjKVxyXG5GdXR1cmUud3JhcCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgLy8gZnVuY3Rpb25cclxuICAgIGlmKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICB2YXIgZm4gPSBhcmd1bWVudHNbMF1cclxuICAgICAgICB2YXIgb2JqZWN0ID0gdW5kZWZpbmVkXHJcblxyXG5cclxuICAgIC8vIG9iamVjdCwgZnVuY3Rpb25cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdmFyIG9iamVjdCA9IGFyZ3VtZW50c1swXVxyXG4gICAgICAgIHZhciBmbiA9IG9iamVjdFthcmd1bWVudHNbMV1dXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKVxyXG4gICAgICAgIHZhciBmdXR1cmUgPSBuZXcgRnV0dXJlXHJcbiAgICAgICAgYXJncy5wdXNoKGZ1dHVyZS5yZXNvbHZlcigpKVxyXG4gICAgICAgIHZhciBtZSA9IHRoaXNcclxuICAgICAgICBpZihvYmplY3QpIG1lID0gb2JqZWN0XHJcbiAgICAgICAgZm4uYXBwbHkobWUsIGFyZ3MpXHJcbiAgICAgICAgcmV0dXJuIGZ1dHVyZVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuLy8gZGVmYXVsdFxyXG52YXIgdW5oYW5kbGVkRXJyb3JIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICB0aHJvdyBlXHJcbiAgICB9LDApXHJcbn1cclxuXHJcbi8vIHNldHVwIHVuaGFuZGxlZCBlcnJvciBoYW5kbGVyXHJcbi8vIHVuaGFuZGxlZCBlcnJvcnMgaGFwcGVuIHdoZW4gZG9uZSBpcyBjYWxsZWQsIGFuZCAgdGhlbiBhbiBleGNlcHRpb24gaXMgdGhyb3duIGZyb20gdGhlIGZ1dHVyZVxyXG5GdXR1cmUuZXJyb3IgPSBmdW5jdGlvbihoYW5kbGVyKSB7XHJcbiAgICB1bmhhbmRsZWRFcnJvckhhbmRsZXIgPSBoYW5kbGVyXHJcbn1cclxuXHJcbi8vIGluc3RhbmNlIG1ldGhvZHNcclxuXHJcbi8vIHJldHVybnMgYSB2YWx1ZSBmb3IgdGhlIGZ1dHVyZSAoY2FuIG9ubHkgYmUgZXhlY3V0ZWQgb25jZSlcclxuLy8gaWYgdGhlcmUgYXJlIGNhbGxiYWNrcyB3YWl0aW5nIG9uIHRoaXMgdmFsdWUsIHRoZXkgYXJlIHJ1biBpbiB0aGUgbmV4dCB0aWNrXHJcbiAgICAvLyAoaWUgdGhleSBhcmVuJ3QgcnVuIGltbWVkaWF0ZWx5LCBhbGxvd2luZyB0aGUgY3VycmVudCB0aHJlYWQgb2YgZXhlY3V0aW9uIHRvIGNvbXBsZXRlKVxyXG5GdXR1cmUucHJvdG90eXBlLnJldHVybiA9IGZ1bmN0aW9uKHYpIHtcclxuICAgIHJlc29sdmUodGhpcywgJ3JldHVybicsIHYpXHJcbn1cclxuRnV0dXJlLnByb3RvdHlwZS50aHJvdyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgIHJlc29sdmUodGhpcywgJ2Vycm9yJywgZSlcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0TmV4dCh0aGF0LCBmdXR1cmUpIHtcclxuICAgIGlmKGZ1dHVyZSAhPT0gdW5kZWZpbmVkICYmICFpc0xpa2VBRnV0dXJlKGZ1dHVyZSkgKVxyXG4gICAgICAgIHRocm93IEVycm9yKFwiVmFsdWUgcmV0dXJuZWQgZnJvbSB0aGVuIG9yIGNhdGNoICpub3QqIGEgRnV0dXJlOiBcIitmdXR1cmUpXHJcblxyXG4gICAgcmVzb2x2ZSh0aGF0LCAnbmV4dCcsIGZ1dHVyZSlcclxufVxyXG5cclxuZnVuY3Rpb24gd2FpdCh0aGF0LCBjYikge1xyXG4gICAgaWYodGhhdC5pc1Jlc29sdmVkKSB7XHJcbiAgICAgICAgZXhlY3V0ZUNhbGxiYWNrcyh0aGF0LCBbY2JdKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aGF0LnF1ZXVlLnB1c2goY2IpXHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIGR1Y2sgdHlwaW5nIHRvIGRldGVybWluZSBpZiBzb21ldGhpbmcgaXMgb3IgaXNuJ3QgYSBmdXR1cmVcclxuZnVuY3Rpb24gaXNMaWtlQUZ1dHVyZSh4KSB7XHJcbiAgICByZXR1cm4geC5pc1Jlc29sdmVkICE9PSB1bmRlZmluZWQgJiYgeC5xdWV1ZSAhPT0gdW5kZWZpbmVkICYmIHgudGhlbiAhPT0gdW5kZWZpbmVkXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHdhaXRPblJlc3VsdChmLCByZXN1bHQsIGNiKSB7XHJcbiAgICB3YWl0KHJlc3VsdCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYodGhpcy5oYXNFcnJvcikge1xyXG4gICAgICAgICAgICBmLnRocm93KHRoaXMuZXJyb3IpXHJcbiAgICAgICAgfSBlbHNlIGlmKHRoaXMuaGFzTmV4dCkge1xyXG4gICAgICAgICAgICB3YWl0T25SZXN1bHQoZiwgdGhpcy5uZXh0LCBjYilcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgc2V0TmV4dChmLCBjYih0aGlzLnJlc3VsdCkpXHJcbiAgICAgICAgICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgICAgICAgICAgZi50aHJvdyhlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufVxyXG5cclxuXHJcbi8vIGNiIHRha2VzIG9uZSBwYXJhbWV0ZXIgLSB0aGUgdmFsdWUgcmV0dXJuZWRcclxuLy8gY2IgY2FuIHJldHVybiBhIEZ1dHVyZSwgaW4gd2hpY2ggY2FzZSB0aGUgcmVzdWx0IG9mIHRoYXQgRnV0dXJlIGlzIHBhc3NlZCB0byBuZXh0LWluLWNoYWluXHJcbkZ1dHVyZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uKGNiKSB7XHJcbiAgICB2YXIgZiA9IG5ldyBGdXR1cmVcclxuICAgIHdhaXQodGhpcywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYodGhpcy5oYXNFcnJvcilcclxuICAgICAgICAgICAgZi50aHJvdyh0aGlzLmVycm9yKVxyXG4gICAgICAgIGVsc2UgaWYodGhpcy5oYXNOZXh0KVxyXG4gICAgICAgICAgICB3YWl0T25SZXN1bHQoZiwgdGhpcy5uZXh0LCBjYilcclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHNldE5leHQoZiwgY2IodGhpcy5yZXN1bHQpKVxyXG4gICAgICAgICAgICB9IGNhdGNoKGUpIHtcclxuICAgICAgICAgICAgICAgIGYudGhyb3coZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICByZXR1cm4gZlxyXG59XHJcbi8vIGNiIHRha2VzIG9uZSBwYXJhbWV0ZXIgLSB0aGUgZXJyb3IgY2F1Z2h0XHJcbi8vIGNiIGNhbiByZXR1cm4gYSBGdXR1cmUsIGluIHdoaWNoIGNhc2UgdGhlIHJlc3VsdCBvZiB0aGF0IEZ1dHVyZSBpcyBwYXNzZWQgdG8gbmV4dC1pbi1jaGFpblxyXG5GdXR1cmUucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24oY2IpIHtcclxuICAgIHZhciBmID0gbmV3IEZ1dHVyZVxyXG4gICAgd2FpdCh0aGlzLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZih0aGlzLmhhc0Vycm9yKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBzZXROZXh0KGYsIGNiKHRoaXMuZXJyb3IpKVxyXG4gICAgICAgICAgICB9IGNhdGNoKGUpIHtcclxuICAgICAgICAgICAgICAgIGYudGhyb3coZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZih0aGlzLmhhc05leHQpIHtcclxuICAgICAgICAgICAgdGhpcy5uZXh0LnRoZW4oZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgZi5yZXR1cm4odilcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgc2V0TmV4dChmLCBjYihlKSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmLnJldHVybih0aGlzLnJlc3VsdClcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgcmV0dXJuIGZcclxufVxyXG4vLyBjYiB0YWtlcyBubyBwYXJhbWV0ZXJzXHJcbi8vIGNhbGxiYWNrJ3MgcmV0dXJuIHZhbHVlIGlzIGlnbm9yZWQsIGJ1dCB0aHJvd24gZXhjZXB0aW9ucyBwcm9wb2dhdGUgbm9ybWFsbHlcclxuRnV0dXJlLnByb3RvdHlwZS5maW5hbGx5ID0gZnVuY3Rpb24oY2IpIHtcclxuICAgIHZhciBmID0gbmV3IEZ1dHVyZVxyXG4gICAgd2FpdCh0aGlzLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZih0aGlzLmhhc05leHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmV4dC50aGVuKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGNiKClcclxuICAgICAgICAgICAgICAgICAgICBmLnJldHVybih2KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBjYigpXHJcbiAgICAgICAgICAgICAgICAgICAgZi50aHJvdyhlKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4XHJcbiAgICAgICAgICAgICAgICB9KS5kb25lKClcclxuICAgICAgICAgICAgfSBlbHNlIGlmKHRoaXMuaGFzRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIEZ1dHVyZSh0cnVlKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjYigpXHJcbiAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYudGhyb3codGhpcy5lcnJvcilcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBmLnRocm93KGUpXHJcbiAgICAgICAgICAgICAgICB9KS5kb25lKClcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSAge1xyXG4gICAgICAgICAgICAgICAgRnV0dXJlKHRydWUpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNiKClcclxuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZi5yZXR1cm4odGhpcy5yZXN1bHQpXHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZi50aHJvdyhlKVxyXG4gICAgICAgICAgICAgICAgfSkuZG9uZSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoKGUpIHtcclxuICAgICAgICAgICAgZi50aHJvdyhlKVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICByZXR1cm4gZlxyXG59XHJcblxyXG4vLyBhbGwgdW51c2VkIGZ1dHVyZXMgc2hvdWxkIGVuZCB3aXRoIHRoaXMgKGUuZy4gbW9zdCB0aGVuLWNoYWlucylcclxuLy8gZGV0YXRjaGVzIHRoZSBmdXR1cmUgc28gYW55IHByb3BvZ2F0ZWQgZXhjZXB0aW9uIGlzIHRocm93biAoc28gdGhlIGV4Y2VwdGlvbiBpc24ndCBzaWxlbnRseSBsb3N0KVxyXG5GdXR1cmUucHJvdG90eXBlLmRvbmUgPSBmdW5jdGlvbigpIHtcclxuICAgIHdhaXQodGhpcywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYodGhpcy5oYXNFcnJvcikge1xyXG4gICAgICAgICAgICB1bmhhbmRsZWRFcnJvckhhbmRsZXIodGhpcy5lcnJvcilcclxuICAgICAgICB9IGVsc2UgaWYodGhpcy5oYXNOZXh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV4dC5jYXRjaChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB1bmhhbmRsZWRFcnJvckhhbmRsZXIoZSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59XHJcblxyXG5cclxuXHJcbkZ1dHVyZS5wcm90b3R5cGUucmVzb2x2ZXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBtZSA9IHRoaXNcclxuXHJcbiAgICByZXR1cm4gZnVuY3Rpb24oZSx2KSB7XHJcbiAgICAgICAgaWYoZSkgeyAvLyBlcnJvciBhcmd1bWVudFxyXG4gICAgICAgICAgICBtZS50aHJvdyhlKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1lLnJldHVybih2KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuRnV0dXJlLnByb3RvdHlwZS5yZXNvbHZlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaXNSZXNvbHZlZFxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gcmVzb2x2ZSh0aGF0LCB0eXBlLCB2YWx1ZSkge1xyXG4gICAgaWYodGhhdC5pc1Jlc29sdmVkKVxyXG4gICAgICAgIHRocm93IEVycm9yKFwiRnV0dXJlIHJlc29sdmVkIG1vcmUgdGhhbiBvbmNlISBSZXNvbHV0aW9uOiBcIit2YWx1ZSlcclxuXHJcbiAgICB0aGF0LmlzUmVzb2x2ZWQgPSB0cnVlXHJcbiAgICB0aGF0Lmhhc0Vycm9yID0gdHlwZSA9PT0gJ2Vycm9yJ1xyXG4gICAgdGhhdC5oYXNOZXh0ID0gdHlwZSA9PT0gJ25leHQnICYmIHZhbHVlICE9PSB1bmRlZmluZWRcclxuXHJcbiAgICBpZih0aGF0Lmhhc0Vycm9yKVxyXG4gICAgICAgIHRoYXQuZXJyb3IgPSB2YWx1ZVxyXG4gICAgZWxzZSBpZih0aGF0Lmhhc05leHQpXHJcbiAgICAgICAgdGhhdC5uZXh0ID0gdmFsdWVcclxuICAgIGVsc2VcclxuICAgICAgICB0aGF0LnJlc3VsdCA9IHZhbHVlXHJcblxyXG4gICAgZXhlY3V0ZUNhbGxiYWNrcyh0aGF0LCB0aGF0LnF1ZXVlKVxyXG59XHJcblxyXG5mdW5jdGlvbiBleGVjdXRlQ2FsbGJhY2tzKHRoYXQsIGNhbGxiYWNrcykge1xyXG4gICAgaWYoY2FsbGJhY2tzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbihjYikge1xyXG4gICAgICAgICAgICAgICAgY2IuYXBwbHkodGhhdClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LDApXHJcbiAgICB9XHJcbn1cclxuIiwiLy8gcmVzb2x2ZXMgdmFyYXJncyB2YXJpYWJsZSBpbnRvIG1vcmUgdXNhYmxlIGZvcm1cbi8vIGFyZ3MgLSBzaG91bGQgYmUgYSBmdW5jdGlvbiBhcmd1bWVudHMgdmFyaWFibGVcbi8vIHJldHVybnMgYSBqYXZhc2NyaXB0IEFycmF5IG9iamVjdCBvZiBhcmd1bWVudHMgdGhhdCBkb2Vzbid0IGNvdW50IHRyYWlsaW5nIHVuZGVmaW5lZCB2YWx1ZXMgaW4gdGhlIGxlbmd0aFxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih0aGVBcmd1bWVudHMpIHtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoZUFyZ3VtZW50cywgMClcblxuICAgIHZhciBjb3VudCA9IDA7XG4gICAgZm9yKHZhciBuPWFyZ3MubGVuZ3RoLTE7IG4+PTA7IG4tLSkge1xuICAgICAgICBpZihhcmdzW25dID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBjb3VudCsrXG4gICAgfVxuICAgIGFyZ3Muc3BsaWNlKC0wLCBjb3VudClcbiAgICByZXR1cm4gYXJnc1xufSIsImlmICh0eXBlb2YgT2JqZWN0LmNyZWF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAvLyBpbXBsZW1lbnRhdGlvbiBmcm9tIHN0YW5kYXJkIG5vZGUuanMgJ3V0aWwnIG1vZHVsZVxuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3Rvcikge1xuICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yXG4gICAgY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ3Rvci5wcm90b3R5cGUsIHtcbiAgICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICAgIHZhbHVlOiBjdG9yLFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xufSBlbHNlIHtcbiAgLy8gb2xkIHNjaG9vbCBzaGltIGZvciBvbGQgYnJvd3NlcnNcbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbmhlcml0cyhjdG9yLCBzdXBlckN0b3IpIHtcbiAgICBjdG9yLnN1cGVyXyA9IHN1cGVyQ3RvclxuICAgIHZhciBUZW1wQ3RvciA9IGZ1bmN0aW9uICgpIHt9XG4gICAgVGVtcEN0b3IucHJvdG90eXBlID0gc3VwZXJDdG9yLnByb3RvdHlwZVxuICAgIGN0b3IucHJvdG90eXBlID0gbmV3IFRlbXBDdG9yKClcbiAgICBjdG9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGN0b3JcbiAgfVxufVxuIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG5cbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxucHJvY2Vzcy5uZXh0VGljayA9IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNhblNldEltbWVkaWF0ZSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgJiYgd2luZG93LnNldEltbWVkaWF0ZTtcbiAgICB2YXIgY2FuUG9zdCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgJiYgd2luZG93LnBvc3RNZXNzYWdlICYmIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyXG4gICAgO1xuXG4gICAgaWYgKGNhblNldEltbWVkaWF0ZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHdpbmRvdy5zZXRJbW1lZGlhdGUoZikgfTtcbiAgICB9XG5cbiAgICBpZiAoY2FuUG9zdCkge1xuICAgICAgICB2YXIgcXVldWUgPSBbXTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBldi5zb3VyY2U7XG4gICAgICAgICAgICBpZiAoKHNvdXJjZSA9PT0gd2luZG93IHx8IHNvdXJjZSA9PT0gbnVsbCkgJiYgZXYuZGF0YSA9PT0gJ3Byb2Nlc3MtdGljaycpIHtcbiAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAocXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm4gPSBxdWV1ZS5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgdHJ1ZSk7XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5leHRUaWNrKGZuKSB7XG4gICAgICAgICAgICBxdWV1ZS5wdXNoKGZuKTtcbiAgICAgICAgICAgIHdpbmRvdy5wb3N0TWVzc2FnZSgncHJvY2Vzcy10aWNrJywgJyonKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcbiAgICAgICAgc2V0VGltZW91dChmbiwgMCk7XG4gICAgfTtcbn0pKCk7XG5cbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59XG5cbi8vIFRPRE8oc2h0eWxtYW4pXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaXNCdWZmZXIoYXJnKSB7XG4gIHJldHVybiBhcmcgJiYgdHlwZW9mIGFyZyA9PT0gJ29iamVjdCdcbiAgICAmJiB0eXBlb2YgYXJnLmNvcHkgPT09ICdmdW5jdGlvbidcbiAgICAmJiB0eXBlb2YgYXJnLmZpbGwgPT09ICdmdW5jdGlvbidcbiAgICAmJiB0eXBlb2YgYXJnLnJlYWRVSW50OCA9PT0gJ2Z1bmN0aW9uJztcbn0iLCIoZnVuY3Rpb24gKHByb2Nlc3MsZ2xvYmFsKXtcbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgZm9ybWF0UmVnRXhwID0gLyVbc2RqJV0vZztcbmV4cG9ydHMuZm9ybWF0ID0gZnVuY3Rpb24oZikge1xuICBpZiAoIWlzU3RyaW5nKGYpKSB7XG4gICAgdmFyIG9iamVjdHMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgb2JqZWN0cy5wdXNoKGluc3BlY3QoYXJndW1lbnRzW2ldKSk7XG4gICAgfVxuICAgIHJldHVybiBvYmplY3RzLmpvaW4oJyAnKTtcbiAgfVxuXG4gIHZhciBpID0gMTtcbiAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gIHZhciBsZW4gPSBhcmdzLmxlbmd0aDtcbiAgdmFyIHN0ciA9IFN0cmluZyhmKS5yZXBsYWNlKGZvcm1hdFJlZ0V4cCwgZnVuY3Rpb24oeCkge1xuICAgIGlmICh4ID09PSAnJSUnKSByZXR1cm4gJyUnO1xuICAgIGlmIChpID49IGxlbikgcmV0dXJuIHg7XG4gICAgc3dpdGNoICh4KSB7XG4gICAgICBjYXNlICclcyc6IHJldHVybiBTdHJpbmcoYXJnc1tpKytdKTtcbiAgICAgIGNhc2UgJyVkJzogcmV0dXJuIE51bWJlcihhcmdzW2krK10pO1xuICAgICAgY2FzZSAnJWonOlxuICAgICAgICB0cnkge1xuICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShhcmdzW2krK10pO1xuICAgICAgICB9IGNhdGNoIChfKSB7XG4gICAgICAgICAgcmV0dXJuICdbQ2lyY3VsYXJdJztcbiAgICAgICAgfVxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHg7XG4gICAgfVxuICB9KTtcbiAgZm9yICh2YXIgeCA9IGFyZ3NbaV07IGkgPCBsZW47IHggPSBhcmdzWysraV0pIHtcbiAgICBpZiAoaXNOdWxsKHgpIHx8ICFpc09iamVjdCh4KSkge1xuICAgICAgc3RyICs9ICcgJyArIHg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0ciArPSAnICcgKyBpbnNwZWN0KHgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc3RyO1xufTtcblxuXG4vLyBNYXJrIHRoYXQgYSBtZXRob2Qgc2hvdWxkIG5vdCBiZSB1c2VkLlxuLy8gUmV0dXJucyBhIG1vZGlmaWVkIGZ1bmN0aW9uIHdoaWNoIHdhcm5zIG9uY2UgYnkgZGVmYXVsdC5cbi8vIElmIC0tbm8tZGVwcmVjYXRpb24gaXMgc2V0LCB0aGVuIGl0IGlzIGEgbm8tb3AuXG5leHBvcnRzLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKGZuLCBtc2cpIHtcbiAgLy8gQWxsb3cgZm9yIGRlcHJlY2F0aW5nIHRoaW5ncyBpbiB0aGUgcHJvY2VzcyBvZiBzdGFydGluZyB1cC5cbiAgaWYgKGlzVW5kZWZpbmVkKGdsb2JhbC5wcm9jZXNzKSkge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBleHBvcnRzLmRlcHJlY2F0ZShmbiwgbXNnKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH1cblxuICBpZiAocHJvY2Vzcy5ub0RlcHJlY2F0aW9uID09PSB0cnVlKSB7XG4gICAgcmV0dXJuIGZuO1xuICB9XG5cbiAgdmFyIHdhcm5lZCA9IGZhbHNlO1xuICBmdW5jdGlvbiBkZXByZWNhdGVkKCkge1xuICAgIGlmICghd2FybmVkKSB7XG4gICAgICBpZiAocHJvY2Vzcy50aHJvd0RlcHJlY2F0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICAgICAgfSBlbHNlIGlmIChwcm9jZXNzLnRyYWNlRGVwcmVjYXRpb24pIHtcbiAgICAgICAgY29uc29sZS50cmFjZShtc2cpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihtc2cpO1xuICAgICAgfVxuICAgICAgd2FybmVkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICByZXR1cm4gZGVwcmVjYXRlZDtcbn07XG5cblxudmFyIGRlYnVncyA9IHt9O1xudmFyIGRlYnVnRW52aXJvbjtcbmV4cG9ydHMuZGVidWdsb2cgPSBmdW5jdGlvbihzZXQpIHtcbiAgaWYgKGlzVW5kZWZpbmVkKGRlYnVnRW52aXJvbikpXG4gICAgZGVidWdFbnZpcm9uID0gcHJvY2Vzcy5lbnYuTk9ERV9ERUJVRyB8fCAnJztcbiAgc2V0ID0gc2V0LnRvVXBwZXJDYXNlKCk7XG4gIGlmICghZGVidWdzW3NldF0pIHtcbiAgICBpZiAobmV3IFJlZ0V4cCgnXFxcXGInICsgc2V0ICsgJ1xcXFxiJywgJ2knKS50ZXN0KGRlYnVnRW52aXJvbikpIHtcbiAgICAgIHZhciBwaWQgPSBwcm9jZXNzLnBpZDtcbiAgICAgIGRlYnVnc1tzZXRdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBtc2cgPSBleHBvcnRzLmZvcm1hdC5hcHBseShleHBvcnRzLCBhcmd1bWVudHMpO1xuICAgICAgICBjb25zb2xlLmVycm9yKCclcyAlZDogJXMnLCBzZXQsIHBpZCwgbXNnKTtcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGRlYnVnc1tzZXRdID0gZnVuY3Rpb24oKSB7fTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGRlYnVnc1tzZXRdO1xufTtcblxuXG4vKipcbiAqIEVjaG9zIHRoZSB2YWx1ZSBvZiBhIHZhbHVlLiBUcnlzIHRvIHByaW50IHRoZSB2YWx1ZSBvdXRcbiAqIGluIHRoZSBiZXN0IHdheSBwb3NzaWJsZSBnaXZlbiB0aGUgZGlmZmVyZW50IHR5cGVzLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBwcmludCBvdXQuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0cyBPcHRpb25hbCBvcHRpb25zIG9iamVjdCB0aGF0IGFsdGVycyB0aGUgb3V0cHV0LlxuICovXG4vKiBsZWdhY3k6IG9iaiwgc2hvd0hpZGRlbiwgZGVwdGgsIGNvbG9ycyovXG5mdW5jdGlvbiBpbnNwZWN0KG9iaiwgb3B0cykge1xuICAvLyBkZWZhdWx0IG9wdGlvbnNcbiAgdmFyIGN0eCA9IHtcbiAgICBzZWVuOiBbXSxcbiAgICBzdHlsaXplOiBzdHlsaXplTm9Db2xvclxuICB9O1xuICAvLyBsZWdhY3kuLi5cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMykgY3R4LmRlcHRoID0gYXJndW1lbnRzWzJdO1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSA0KSBjdHguY29sb3JzID0gYXJndW1lbnRzWzNdO1xuICBpZiAoaXNCb29sZWFuKG9wdHMpKSB7XG4gICAgLy8gbGVnYWN5Li4uXG4gICAgY3R4LnNob3dIaWRkZW4gPSBvcHRzO1xuICB9IGVsc2UgaWYgKG9wdHMpIHtcbiAgICAvLyBnb3QgYW4gXCJvcHRpb25zXCIgb2JqZWN0XG4gICAgZXhwb3J0cy5fZXh0ZW5kKGN0eCwgb3B0cyk7XG4gIH1cbiAgLy8gc2V0IGRlZmF1bHQgb3B0aW9uc1xuICBpZiAoaXNVbmRlZmluZWQoY3R4LnNob3dIaWRkZW4pKSBjdHguc2hvd0hpZGRlbiA9IGZhbHNlO1xuICBpZiAoaXNVbmRlZmluZWQoY3R4LmRlcHRoKSkgY3R4LmRlcHRoID0gMjtcbiAgaWYgKGlzVW5kZWZpbmVkKGN0eC5jb2xvcnMpKSBjdHguY29sb3JzID0gZmFsc2U7XG4gIGlmIChpc1VuZGVmaW5lZChjdHguY3VzdG9tSW5zcGVjdCkpIGN0eC5jdXN0b21JbnNwZWN0ID0gdHJ1ZTtcbiAgaWYgKGN0eC5jb2xvcnMpIGN0eC5zdHlsaXplID0gc3R5bGl6ZVdpdGhDb2xvcjtcbiAgcmV0dXJuIGZvcm1hdFZhbHVlKGN0eCwgb2JqLCBjdHguZGVwdGgpO1xufVxuZXhwb3J0cy5pbnNwZWN0ID0gaW5zcGVjdDtcblxuXG4vLyBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0FOU0lfZXNjYXBlX2NvZGUjZ3JhcGhpY3Ncbmluc3BlY3QuY29sb3JzID0ge1xuICAnYm9sZCcgOiBbMSwgMjJdLFxuICAnaXRhbGljJyA6IFszLCAyM10sXG4gICd1bmRlcmxpbmUnIDogWzQsIDI0XSxcbiAgJ2ludmVyc2UnIDogWzcsIDI3XSxcbiAgJ3doaXRlJyA6IFszNywgMzldLFxuICAnZ3JleScgOiBbOTAsIDM5XSxcbiAgJ2JsYWNrJyA6IFszMCwgMzldLFxuICAnYmx1ZScgOiBbMzQsIDM5XSxcbiAgJ2N5YW4nIDogWzM2LCAzOV0sXG4gICdncmVlbicgOiBbMzIsIDM5XSxcbiAgJ21hZ2VudGEnIDogWzM1LCAzOV0sXG4gICdyZWQnIDogWzMxLCAzOV0sXG4gICd5ZWxsb3cnIDogWzMzLCAzOV1cbn07XG5cbi8vIERvbid0IHVzZSAnYmx1ZScgbm90IHZpc2libGUgb24gY21kLmV4ZVxuaW5zcGVjdC5zdHlsZXMgPSB7XG4gICdzcGVjaWFsJzogJ2N5YW4nLFxuICAnbnVtYmVyJzogJ3llbGxvdycsXG4gICdib29sZWFuJzogJ3llbGxvdycsXG4gICd1bmRlZmluZWQnOiAnZ3JleScsXG4gICdudWxsJzogJ2JvbGQnLFxuICAnc3RyaW5nJzogJ2dyZWVuJyxcbiAgJ2RhdGUnOiAnbWFnZW50YScsXG4gIC8vIFwibmFtZVwiOiBpbnRlbnRpb25hbGx5IG5vdCBzdHlsaW5nXG4gICdyZWdleHAnOiAncmVkJ1xufTtcblxuXG5mdW5jdGlvbiBzdHlsaXplV2l0aENvbG9yKHN0ciwgc3R5bGVUeXBlKSB7XG4gIHZhciBzdHlsZSA9IGluc3BlY3Quc3R5bGVzW3N0eWxlVHlwZV07XG5cbiAgaWYgKHN0eWxlKSB7XG4gICAgcmV0dXJuICdcXHUwMDFiWycgKyBpbnNwZWN0LmNvbG9yc1tzdHlsZV1bMF0gKyAnbScgKyBzdHIgK1xuICAgICAgICAgICAnXFx1MDAxYlsnICsgaW5zcGVjdC5jb2xvcnNbc3R5bGVdWzFdICsgJ20nO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBzdHI7XG4gIH1cbn1cblxuXG5mdW5jdGlvbiBzdHlsaXplTm9Db2xvcihzdHIsIHN0eWxlVHlwZSkge1xuICByZXR1cm4gc3RyO1xufVxuXG5cbmZ1bmN0aW9uIGFycmF5VG9IYXNoKGFycmF5KSB7XG4gIHZhciBoYXNoID0ge307XG5cbiAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbih2YWwsIGlkeCkge1xuICAgIGhhc2hbdmFsXSA9IHRydWU7XG4gIH0pO1xuXG4gIHJldHVybiBoYXNoO1xufVxuXG5cbmZ1bmN0aW9uIGZvcm1hdFZhbHVlKGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcykge1xuICAvLyBQcm92aWRlIGEgaG9vayBmb3IgdXNlci1zcGVjaWZpZWQgaW5zcGVjdCBmdW5jdGlvbnMuXG4gIC8vIENoZWNrIHRoYXQgdmFsdWUgaXMgYW4gb2JqZWN0IHdpdGggYW4gaW5zcGVjdCBmdW5jdGlvbiBvbiBpdFxuICBpZiAoY3R4LmN1c3RvbUluc3BlY3QgJiZcbiAgICAgIHZhbHVlICYmXG4gICAgICBpc0Z1bmN0aW9uKHZhbHVlLmluc3BlY3QpICYmXG4gICAgICAvLyBGaWx0ZXIgb3V0IHRoZSB1dGlsIG1vZHVsZSwgaXQncyBpbnNwZWN0IGZ1bmN0aW9uIGlzIHNwZWNpYWxcbiAgICAgIHZhbHVlLmluc3BlY3QgIT09IGV4cG9ydHMuaW5zcGVjdCAmJlxuICAgICAgLy8gQWxzbyBmaWx0ZXIgb3V0IGFueSBwcm90b3R5cGUgb2JqZWN0cyB1c2luZyB0aGUgY2lyY3VsYXIgY2hlY2suXG4gICAgICAhKHZhbHVlLmNvbnN0cnVjdG9yICYmIHZhbHVlLmNvbnN0cnVjdG9yLnByb3RvdHlwZSA9PT0gdmFsdWUpKSB7XG4gICAgdmFyIHJldCA9IHZhbHVlLmluc3BlY3QocmVjdXJzZVRpbWVzLCBjdHgpO1xuICAgIGlmICghaXNTdHJpbmcocmV0KSkge1xuICAgICAgcmV0ID0gZm9ybWF0VmFsdWUoY3R4LCByZXQsIHJlY3Vyc2VUaW1lcyk7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH1cblxuICAvLyBQcmltaXRpdmUgdHlwZXMgY2Fubm90IGhhdmUgcHJvcGVydGllc1xuICB2YXIgcHJpbWl0aXZlID0gZm9ybWF0UHJpbWl0aXZlKGN0eCwgdmFsdWUpO1xuICBpZiAocHJpbWl0aXZlKSB7XG4gICAgcmV0dXJuIHByaW1pdGl2ZTtcbiAgfVxuXG4gIC8vIExvb2sgdXAgdGhlIGtleXMgb2YgdGhlIG9iamVjdC5cbiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh2YWx1ZSk7XG4gIHZhciB2aXNpYmxlS2V5cyA9IGFycmF5VG9IYXNoKGtleXMpO1xuXG4gIGlmIChjdHguc2hvd0hpZGRlbikge1xuICAgIGtleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh2YWx1ZSk7XG4gIH1cblxuICAvLyBJRSBkb2Vzbid0IG1ha2UgZXJyb3IgZmllbGRzIG5vbi1lbnVtZXJhYmxlXG4gIC8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9kd3c1MnNidCh2PXZzLjk0KS5hc3B4XG4gIGlmIChpc0Vycm9yKHZhbHVlKVxuICAgICAgJiYgKGtleXMuaW5kZXhPZignbWVzc2FnZScpID49IDAgfHwga2V5cy5pbmRleE9mKCdkZXNjcmlwdGlvbicpID49IDApKSB7XG4gICAgcmV0dXJuIGZvcm1hdEVycm9yKHZhbHVlKTtcbiAgfVxuXG4gIC8vIFNvbWUgdHlwZSBvZiBvYmplY3Qgd2l0aG91dCBwcm9wZXJ0aWVzIGNhbiBiZSBzaG9ydGN1dHRlZC5cbiAgaWYgKGtleXMubGVuZ3RoID09PSAwKSB7XG4gICAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICB2YXIgbmFtZSA9IHZhbHVlLm5hbWUgPyAnOiAnICsgdmFsdWUubmFtZSA6ICcnO1xuICAgICAgcmV0dXJuIGN0eC5zdHlsaXplKCdbRnVuY3Rpb24nICsgbmFtZSArICddJywgJ3NwZWNpYWwnKTtcbiAgICB9XG4gICAgaWYgKGlzUmVnRXhwKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIGN0eC5zdHlsaXplKFJlZ0V4cC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSksICdyZWdleHAnKTtcbiAgICB9XG4gICAgaWYgKGlzRGF0ZSh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiBjdHguc3R5bGl6ZShEYXRlLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSwgJ2RhdGUnKTtcbiAgICB9XG4gICAgaWYgKGlzRXJyb3IodmFsdWUpKSB7XG4gICAgICByZXR1cm4gZm9ybWF0RXJyb3IodmFsdWUpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBiYXNlID0gJycsIGFycmF5ID0gZmFsc2UsIGJyYWNlcyA9IFsneycsICd9J107XG5cbiAgLy8gTWFrZSBBcnJheSBzYXkgdGhhdCB0aGV5IGFyZSBBcnJheVxuICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcbiAgICBhcnJheSA9IHRydWU7XG4gICAgYnJhY2VzID0gWydbJywgJ10nXTtcbiAgfVxuXG4gIC8vIE1ha2UgZnVuY3Rpb25zIHNheSB0aGF0IHRoZXkgYXJlIGZ1bmN0aW9uc1xuICBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICB2YXIgbiA9IHZhbHVlLm5hbWUgPyAnOiAnICsgdmFsdWUubmFtZSA6ICcnO1xuICAgIGJhc2UgPSAnIFtGdW5jdGlvbicgKyBuICsgJ10nO1xuICB9XG5cbiAgLy8gTWFrZSBSZWdFeHBzIHNheSB0aGF0IHRoZXkgYXJlIFJlZ0V4cHNcbiAgaWYgKGlzUmVnRXhwKHZhbHVlKSkge1xuICAgIGJhc2UgPSAnICcgKyBSZWdFeHAucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpO1xuICB9XG5cbiAgLy8gTWFrZSBkYXRlcyB3aXRoIHByb3BlcnRpZXMgZmlyc3Qgc2F5IHRoZSBkYXRlXG4gIGlmIChpc0RhdGUodmFsdWUpKSB7XG4gICAgYmFzZSA9ICcgJyArIERhdGUucHJvdG90eXBlLnRvVVRDU3RyaW5nLmNhbGwodmFsdWUpO1xuICB9XG5cbiAgLy8gTWFrZSBlcnJvciB3aXRoIG1lc3NhZ2UgZmlyc3Qgc2F5IHRoZSBlcnJvclxuICBpZiAoaXNFcnJvcih2YWx1ZSkpIHtcbiAgICBiYXNlID0gJyAnICsgZm9ybWF0RXJyb3IodmFsdWUpO1xuICB9XG5cbiAgaWYgKGtleXMubGVuZ3RoID09PSAwICYmICghYXJyYXkgfHwgdmFsdWUubGVuZ3RoID09IDApKSB7XG4gICAgcmV0dXJuIGJyYWNlc1swXSArIGJhc2UgKyBicmFjZXNbMV07XG4gIH1cblxuICBpZiAocmVjdXJzZVRpbWVzIDwgMCkge1xuICAgIGlmIChpc1JlZ0V4cCh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiBjdHguc3R5bGl6ZShSZWdFeHAucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpLCAncmVnZXhwJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBjdHguc3R5bGl6ZSgnW09iamVjdF0nLCAnc3BlY2lhbCcpO1xuICAgIH1cbiAgfVxuXG4gIGN0eC5zZWVuLnB1c2godmFsdWUpO1xuXG4gIHZhciBvdXRwdXQ7XG4gIGlmIChhcnJheSkge1xuICAgIG91dHB1dCA9IGZvcm1hdEFycmF5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsIGtleXMpO1xuICB9IGVsc2Uge1xuICAgIG91dHB1dCA9IGtleXMubWFwKGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIGZvcm1hdFByb3BlcnR5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsIGtleSwgYXJyYXkpO1xuICAgIH0pO1xuICB9XG5cbiAgY3R4LnNlZW4ucG9wKCk7XG5cbiAgcmV0dXJuIHJlZHVjZVRvU2luZ2xlU3RyaW5nKG91dHB1dCwgYmFzZSwgYnJhY2VzKTtcbn1cblxuXG5mdW5jdGlvbiBmb3JtYXRQcmltaXRpdmUoY3R4LCB2YWx1ZSkge1xuICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKVxuICAgIHJldHVybiBjdHguc3R5bGl6ZSgndW5kZWZpbmVkJywgJ3VuZGVmaW5lZCcpO1xuICBpZiAoaXNTdHJpbmcodmFsdWUpKSB7XG4gICAgdmFyIHNpbXBsZSA9ICdcXCcnICsgSlNPTi5zdHJpbmdpZnkodmFsdWUpLnJlcGxhY2UoL15cInxcIiQvZywgJycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxcXFwiL2csICdcIicpICsgJ1xcJyc7XG4gICAgcmV0dXJuIGN0eC5zdHlsaXplKHNpbXBsZSwgJ3N0cmluZycpO1xuICB9XG4gIGlmIChpc051bWJlcih2YWx1ZSkpXG4gICAgcmV0dXJuIGN0eC5zdHlsaXplKCcnICsgdmFsdWUsICdudW1iZXInKTtcbiAgaWYgKGlzQm9vbGVhbih2YWx1ZSkpXG4gICAgcmV0dXJuIGN0eC5zdHlsaXplKCcnICsgdmFsdWUsICdib29sZWFuJyk7XG4gIC8vIEZvciBzb21lIHJlYXNvbiB0eXBlb2YgbnVsbCBpcyBcIm9iamVjdFwiLCBzbyBzcGVjaWFsIGNhc2UgaGVyZS5cbiAgaWYgKGlzTnVsbCh2YWx1ZSkpXG4gICAgcmV0dXJuIGN0eC5zdHlsaXplKCdudWxsJywgJ251bGwnKTtcbn1cblxuXG5mdW5jdGlvbiBmb3JtYXRFcnJvcih2YWx1ZSkge1xuICByZXR1cm4gJ1snICsgRXJyb3IucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpICsgJ10nO1xufVxuXG5cbmZ1bmN0aW9uIGZvcm1hdEFycmF5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsIGtleXMpIHtcbiAgdmFyIG91dHB1dCA9IFtdO1xuICBmb3IgKHZhciBpID0gMCwgbCA9IHZhbHVlLmxlbmd0aDsgaSA8IGw7ICsraSkge1xuICAgIGlmIChoYXNPd25Qcm9wZXJ0eSh2YWx1ZSwgU3RyaW5nKGkpKSkge1xuICAgICAgb3V0cHV0LnB1c2goZm9ybWF0UHJvcGVydHkoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzLCB2aXNpYmxlS2V5cyxcbiAgICAgICAgICBTdHJpbmcoaSksIHRydWUpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3V0cHV0LnB1c2goJycpO1xuICAgIH1cbiAgfVxuICBrZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgaWYgKCFrZXkubWF0Y2goL15cXGQrJC8pKSB7XG4gICAgICBvdXRwdXQucHVzaChmb3JtYXRQcm9wZXJ0eShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLFxuICAgICAgICAgIGtleSwgdHJ1ZSkpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBvdXRwdXQ7XG59XG5cblxuZnVuY3Rpb24gZm9ybWF0UHJvcGVydHkoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzLCB2aXNpYmxlS2V5cywga2V5LCBhcnJheSkge1xuICB2YXIgbmFtZSwgc3RyLCBkZXNjO1xuICBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih2YWx1ZSwga2V5KSB8fCB7IHZhbHVlOiB2YWx1ZVtrZXldIH07XG4gIGlmIChkZXNjLmdldCkge1xuICAgIGlmIChkZXNjLnNldCkge1xuICAgICAgc3RyID0gY3R4LnN0eWxpemUoJ1tHZXR0ZXIvU2V0dGVyXScsICdzcGVjaWFsJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0ciA9IGN0eC5zdHlsaXplKCdbR2V0dGVyXScsICdzcGVjaWFsJyk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmIChkZXNjLnNldCkge1xuICAgICAgc3RyID0gY3R4LnN0eWxpemUoJ1tTZXR0ZXJdJywgJ3NwZWNpYWwnKTtcbiAgICB9XG4gIH1cbiAgaWYgKCFoYXNPd25Qcm9wZXJ0eSh2aXNpYmxlS2V5cywga2V5KSkge1xuICAgIG5hbWUgPSAnWycgKyBrZXkgKyAnXSc7XG4gIH1cbiAgaWYgKCFzdHIpIHtcbiAgICBpZiAoY3R4LnNlZW4uaW5kZXhPZihkZXNjLnZhbHVlKSA8IDApIHtcbiAgICAgIGlmIChpc051bGwocmVjdXJzZVRpbWVzKSkge1xuICAgICAgICBzdHIgPSBmb3JtYXRWYWx1ZShjdHgsIGRlc2MudmFsdWUsIG51bGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RyID0gZm9ybWF0VmFsdWUoY3R4LCBkZXNjLnZhbHVlLCByZWN1cnNlVGltZXMgLSAxKTtcbiAgICAgIH1cbiAgICAgIGlmIChzdHIuaW5kZXhPZignXFxuJykgPiAtMSkge1xuICAgICAgICBpZiAoYXJyYXkpIHtcbiAgICAgICAgICBzdHIgPSBzdHIuc3BsaXQoJ1xcbicpLm1hcChmdW5jdGlvbihsaW5lKSB7XG4gICAgICAgICAgICByZXR1cm4gJyAgJyArIGxpbmU7XG4gICAgICAgICAgfSkuam9pbignXFxuJykuc3Vic3RyKDIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0ciA9ICdcXG4nICsgc3RyLnNwbGl0KCdcXG4nKS5tYXAoZnVuY3Rpb24obGluZSkge1xuICAgICAgICAgICAgcmV0dXJuICcgICAnICsgbGluZTtcbiAgICAgICAgICB9KS5qb2luKCdcXG4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzdHIgPSBjdHguc3R5bGl6ZSgnW0NpcmN1bGFyXScsICdzcGVjaWFsJyk7XG4gICAgfVxuICB9XG4gIGlmIChpc1VuZGVmaW5lZChuYW1lKSkge1xuICAgIGlmIChhcnJheSAmJiBrZXkubWF0Y2goL15cXGQrJC8pKSB7XG4gICAgICByZXR1cm4gc3RyO1xuICAgIH1cbiAgICBuYW1lID0gSlNPTi5zdHJpbmdpZnkoJycgKyBrZXkpO1xuICAgIGlmIChuYW1lLm1hdGNoKC9eXCIoW2EtekEtWl9dW2EtekEtWl8wLTldKilcIiQvKSkge1xuICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyKDEsIG5hbWUubGVuZ3RoIC0gMik7XG4gICAgICBuYW1lID0gY3R4LnN0eWxpemUobmFtZSwgJ25hbWUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpXG4gICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXFxcXCIvZywgJ1wiJylcbiAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyheXCJ8XCIkKS9nLCBcIidcIik7XG4gICAgICBuYW1lID0gY3R4LnN0eWxpemUobmFtZSwgJ3N0cmluZycpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuYW1lICsgJzogJyArIHN0cjtcbn1cblxuXG5mdW5jdGlvbiByZWR1Y2VUb1NpbmdsZVN0cmluZyhvdXRwdXQsIGJhc2UsIGJyYWNlcykge1xuICB2YXIgbnVtTGluZXNFc3QgPSAwO1xuICB2YXIgbGVuZ3RoID0gb3V0cHV0LnJlZHVjZShmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICBudW1MaW5lc0VzdCsrO1xuICAgIGlmIChjdXIuaW5kZXhPZignXFxuJykgPj0gMCkgbnVtTGluZXNFc3QrKztcbiAgICByZXR1cm4gcHJldiArIGN1ci5yZXBsYWNlKC9cXHUwMDFiXFxbXFxkXFxkP20vZywgJycpLmxlbmd0aCArIDE7XG4gIH0sIDApO1xuXG4gIGlmIChsZW5ndGggPiA2MCkge1xuICAgIHJldHVybiBicmFjZXNbMF0gK1xuICAgICAgICAgICAoYmFzZSA9PT0gJycgPyAnJyA6IGJhc2UgKyAnXFxuICcpICtcbiAgICAgICAgICAgJyAnICtcbiAgICAgICAgICAgb3V0cHV0LmpvaW4oJyxcXG4gICcpICtcbiAgICAgICAgICAgJyAnICtcbiAgICAgICAgICAgYnJhY2VzWzFdO1xuICB9XG5cbiAgcmV0dXJuIGJyYWNlc1swXSArIGJhc2UgKyAnICcgKyBvdXRwdXQuam9pbignLCAnKSArICcgJyArIGJyYWNlc1sxXTtcbn1cblxuXG4vLyBOT1RFOiBUaGVzZSB0eXBlIGNoZWNraW5nIGZ1bmN0aW9ucyBpbnRlbnRpb25hbGx5IGRvbid0IHVzZSBgaW5zdGFuY2VvZmBcbi8vIGJlY2F1c2UgaXQgaXMgZnJhZ2lsZSBhbmQgY2FuIGJlIGVhc2lseSBmYWtlZCB3aXRoIGBPYmplY3QuY3JlYXRlKClgLlxuZnVuY3Rpb24gaXNBcnJheShhcikge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheShhcik7XG59XG5leHBvcnRzLmlzQXJyYXkgPSBpc0FycmF5O1xuXG5mdW5jdGlvbiBpc0Jvb2xlYW4oYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnYm9vbGVhbic7XG59XG5leHBvcnRzLmlzQm9vbGVhbiA9IGlzQm9vbGVhbjtcblxuZnVuY3Rpb24gaXNOdWxsKGFyZykge1xuICByZXR1cm4gYXJnID09PSBudWxsO1xufVxuZXhwb3J0cy5pc051bGwgPSBpc051bGw7XG5cbmZ1bmN0aW9uIGlzTnVsbE9yVW5kZWZpbmVkKGFyZykge1xuICByZXR1cm4gYXJnID09IG51bGw7XG59XG5leHBvcnRzLmlzTnVsbE9yVW5kZWZpbmVkID0gaXNOdWxsT3JVbmRlZmluZWQ7XG5cbmZ1bmN0aW9uIGlzTnVtYmVyKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ251bWJlcic7XG59XG5leHBvcnRzLmlzTnVtYmVyID0gaXNOdW1iZXI7XG5cbmZ1bmN0aW9uIGlzU3RyaW5nKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ3N0cmluZyc7XG59XG5leHBvcnRzLmlzU3RyaW5nID0gaXNTdHJpbmc7XG5cbmZ1bmN0aW9uIGlzU3ltYm9sKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ3N5bWJvbCc7XG59XG5leHBvcnRzLmlzU3ltYm9sID0gaXNTeW1ib2w7XG5cbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKGFyZykge1xuICByZXR1cm4gYXJnID09PSB2b2lkIDA7XG59XG5leHBvcnRzLmlzVW5kZWZpbmVkID0gaXNVbmRlZmluZWQ7XG5cbmZ1bmN0aW9uIGlzUmVnRXhwKHJlKSB7XG4gIHJldHVybiBpc09iamVjdChyZSkgJiYgb2JqZWN0VG9TdHJpbmcocmUpID09PSAnW29iamVjdCBSZWdFeHBdJztcbn1cbmV4cG9ydHMuaXNSZWdFeHAgPSBpc1JlZ0V4cDtcblxuZnVuY3Rpb24gaXNPYmplY3QoYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiBhcmcgIT09IG51bGw7XG59XG5leHBvcnRzLmlzT2JqZWN0ID0gaXNPYmplY3Q7XG5cbmZ1bmN0aW9uIGlzRGF0ZShkKSB7XG4gIHJldHVybiBpc09iamVjdChkKSAmJiBvYmplY3RUb1N0cmluZyhkKSA9PT0gJ1tvYmplY3QgRGF0ZV0nO1xufVxuZXhwb3J0cy5pc0RhdGUgPSBpc0RhdGU7XG5cbmZ1bmN0aW9uIGlzRXJyb3IoZSkge1xuICByZXR1cm4gaXNPYmplY3QoZSkgJiZcbiAgICAgIChvYmplY3RUb1N0cmluZyhlKSA9PT0gJ1tvYmplY3QgRXJyb3JdJyB8fCBlIGluc3RhbmNlb2YgRXJyb3IpO1xufVxuZXhwb3J0cy5pc0Vycm9yID0gaXNFcnJvcjtcblxuZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdmdW5jdGlvbic7XG59XG5leHBvcnRzLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uO1xuXG5mdW5jdGlvbiBpc1ByaW1pdGl2ZShhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PT0gbnVsbCB8fFxuICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ2Jvb2xlYW4nIHx8XG4gICAgICAgICB0eXBlb2YgYXJnID09PSAnbnVtYmVyJyB8fFxuICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ3N0cmluZycgfHxcbiAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdzeW1ib2wnIHx8ICAvLyBFUzYgc3ltYm9sXG4gICAgICAgICB0eXBlb2YgYXJnID09PSAndW5kZWZpbmVkJztcbn1cbmV4cG9ydHMuaXNQcmltaXRpdmUgPSBpc1ByaW1pdGl2ZTtcblxuZXhwb3J0cy5pc0J1ZmZlciA9IHJlcXVpcmUoJy4vc3VwcG9ydC9pc0J1ZmZlcicpO1xuXG5mdW5jdGlvbiBvYmplY3RUb1N0cmluZyhvKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobyk7XG59XG5cblxuZnVuY3Rpb24gcGFkKG4pIHtcbiAgcmV0dXJuIG4gPCAxMCA/ICcwJyArIG4udG9TdHJpbmcoMTApIDogbi50b1N0cmluZygxMCk7XG59XG5cblxudmFyIG1vbnRocyA9IFsnSmFuJywgJ0ZlYicsICdNYXInLCAnQXByJywgJ01heScsICdKdW4nLCAnSnVsJywgJ0F1ZycsICdTZXAnLFxuICAgICAgICAgICAgICAnT2N0JywgJ05vdicsICdEZWMnXTtcblxuLy8gMjYgRmViIDE2OjE5OjM0XG5mdW5jdGlvbiB0aW1lc3RhbXAoKSB7XG4gIHZhciBkID0gbmV3IERhdGUoKTtcbiAgdmFyIHRpbWUgPSBbcGFkKGQuZ2V0SG91cnMoKSksXG4gICAgICAgICAgICAgIHBhZChkLmdldE1pbnV0ZXMoKSksXG4gICAgICAgICAgICAgIHBhZChkLmdldFNlY29uZHMoKSldLmpvaW4oJzonKTtcbiAgcmV0dXJuIFtkLmdldERhdGUoKSwgbW9udGhzW2QuZ2V0TW9udGgoKV0sIHRpbWVdLmpvaW4oJyAnKTtcbn1cblxuXG4vLyBsb2cgaXMganVzdCBhIHRoaW4gd3JhcHBlciB0byBjb25zb2xlLmxvZyB0aGF0IHByZXBlbmRzIGEgdGltZXN0YW1wXG5leHBvcnRzLmxvZyA9IGZ1bmN0aW9uKCkge1xuICBjb25zb2xlLmxvZygnJXMgLSAlcycsIHRpbWVzdGFtcCgpLCBleHBvcnRzLmZvcm1hdC5hcHBseShleHBvcnRzLCBhcmd1bWVudHMpKTtcbn07XG5cblxuLyoqXG4gKiBJbmhlcml0IHRoZSBwcm90b3R5cGUgbWV0aG9kcyBmcm9tIG9uZSBjb25zdHJ1Y3RvciBpbnRvIGFub3RoZXIuXG4gKlxuICogVGhlIEZ1bmN0aW9uLnByb3RvdHlwZS5pbmhlcml0cyBmcm9tIGxhbmcuanMgcmV3cml0dGVuIGFzIGEgc3RhbmRhbG9uZVxuICogZnVuY3Rpb24gKG5vdCBvbiBGdW5jdGlvbi5wcm90b3R5cGUpLiBOT1RFOiBJZiB0aGlzIGZpbGUgaXMgdG8gYmUgbG9hZGVkXG4gKiBkdXJpbmcgYm9vdHN0cmFwcGluZyB0aGlzIGZ1bmN0aW9uIG5lZWRzIHRvIGJlIHJld3JpdHRlbiB1c2luZyBzb21lIG5hdGl2ZVxuICogZnVuY3Rpb25zIGFzIHByb3RvdHlwZSBzZXR1cCB1c2luZyBub3JtYWwgSmF2YVNjcmlwdCBkb2VzIG5vdCB3b3JrIGFzXG4gKiBleHBlY3RlZCBkdXJpbmcgYm9vdHN0cmFwcGluZyAoc2VlIG1pcnJvci5qcyBpbiByMTE0OTAzKS5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBjdG9yIENvbnN0cnVjdG9yIGZ1bmN0aW9uIHdoaWNoIG5lZWRzIHRvIGluaGVyaXQgdGhlXG4gKiAgICAgcHJvdG90eXBlLlxuICogQHBhcmFtIHtmdW5jdGlvbn0gc3VwZXJDdG9yIENvbnN0cnVjdG9yIGZ1bmN0aW9uIHRvIGluaGVyaXQgcHJvdG90eXBlIGZyb20uXG4gKi9cbmV4cG9ydHMuaW5oZXJpdHMgPSByZXF1aXJlKCdpbmhlcml0cycpO1xuXG5leHBvcnRzLl9leHRlbmQgPSBmdW5jdGlvbihvcmlnaW4sIGFkZCkge1xuICAvLyBEb24ndCBkbyBhbnl0aGluZyBpZiBhZGQgaXNuJ3QgYW4gb2JqZWN0XG4gIGlmICghYWRkIHx8ICFpc09iamVjdChhZGQpKSByZXR1cm4gb3JpZ2luO1xuXG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXMoYWRkKTtcbiAgdmFyIGkgPSBrZXlzLmxlbmd0aDtcbiAgd2hpbGUgKGktLSkge1xuICAgIG9yaWdpbltrZXlzW2ldXSA9IGFkZFtrZXlzW2ldXTtcbiAgfVxuICByZXR1cm4gb3JpZ2luO1xufTtcblxuZnVuY3Rpb24gaGFzT3duUHJvcGVydHkob2JqLCBwcm9wKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbn1cblxufSkuY2FsbCh0aGlzLHJlcXVpcmUoXCJGOlxcXFxiaWxseXNGaWxlXFxcXGNvZGVcXFxcamF2YXNjcmlwdFxcXFxub2RlanNcXFxcZGVhZHVuaXRDb3JlXFxcXG5vZGVfbW9kdWxlc1xcXFxidWlsZC1tb2R1bGVzXFxcXG5vZGVfbW9kdWxlc1xcXFxicm93c2VyaWZ5XFxcXG5vZGVfbW9kdWxlc1xcXFxpbnNlcnQtbW9kdWxlLWdsb2JhbHNcXFxcbm9kZV9tb2R1bGVzXFxcXHByb2Nlc3NcXFxcYnJvd3Nlci5qc1wiKSx0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDoge30pIiwiKGZ1bmN0aW9uIChnbG9iYWwpe1xuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG52YXIgRnV0dXJlID0gcmVxdWlyZSgnYXN5bmMtZnV0dXJlJylcclxuXHJcbmV4cG9ydHMubmFtZSA9IFwiVW5pdCB0ZXN0IHRoZSB1bml0IHRlc3QtcmVzdWx0cyAodGhlc2Ugc2hvdWxkIGFsbCBzdWNjZWVkKVwiXHJcblxyXG5leHBvcnRzLmdldFRlc3RzID0gZnVuY3Rpb24oVW5pdCwgdGVzdEVudmlyb25tZW50LCBpc0RvbmUpIHtcclxuICAgIHZhciBtb3JlRnV0dXJlcyA9IFtdXHJcblxyXG4gICAgaWYodGVzdEVudmlyb25tZW50ID09PSAnd2ViJykge1xyXG4gICAgICAgIHZhciB0ZXN0RmlsZU5hbWUgPSBcImRlYWR1bml0VGVzdHMuYnJvd3Nlci51bWQuanNcIlxyXG5cclxuICAgIH0gZWxzZSBpZih0ZXN0RW52aXJvbm1lbnQgPT09ICdub2RlJykge1xyXG4gICAgICAgIHZhciB0ZXN0RmlsZU5hbWUgPSBcImRlYWR1bml0VGVzdHMuanNcIlxyXG5cclxuICAgIH0gZWxzZSB0aHJvdyBcImludmFsaWQgZW52aXJvbm1lbnQ6IFwiK3Rlc3RFbnZpcm9ubWVudFxyXG5cclxuICAgIHJldHVybiBmdW5jdGlvbih0KSB7XHJcblxyXG4gICAgICAgIHZhciBlcnJvckNvdW50ID0gMFxyXG4gICAgICAgIHRoaXMuZXJyb3IoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBpZihlcnJvckNvdW50ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBlLm1lc3NhZ2UuaW5kZXhPZihcIkFzeW5jXCIgIT09IC0xKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdC5vayhmYWxzZSwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXJyb3JDb3VudCsrXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8qXHJcbiAgICAgICAgdGhpcy50ZXN0KCdzaW1wbGUgc3VjY2VzcycsIGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgdGhpcy5jb3VudCgzKVxyXG4gICAgICAgICAgICB2YXIgdGVzdCA9IFVuaXQudGVzdChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub2sodHJ1ZSlcclxuICAgICAgICAgICAgfSkuZXZlbnRzKHtcclxuICAgICAgICAgICAgICAgIGVuZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSB0ZXN0LnJlc3VsdHMoKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMubmFtZSA9PT0gdW5kZWZpbmVkLCByZXN1bHRzLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLnJlc3VsdHMubGVuZ3RoID09PSAxKVxyXG4gICAgICAgICAgICAgICAgICAgIHQub2socmVzdWx0cy5yZXN1bHRzWzBdLnN1Y2Nlc3MgPT09IHRydWUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgdGhpcy50ZXN0KCdzaW1wbGUgZmFpbHVyZScsIGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgdGhpcy5jb3VudCgzKVxyXG4gICAgICAgICAgICB2YXIgdGVzdCA9IFVuaXQudGVzdChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub2soZmFsc2UpXHJcbiAgICAgICAgICAgIH0pLmV2ZW50cyh7XHJcbiAgICAgICAgICAgICAgICBlbmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gdGVzdC5yZXN1bHRzKClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLm5hbWUgPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMucmVzdWx0cy5sZW5ndGggPT09IDEpXHJcbiAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLnJlc3VsdHNbMF0uc3VjY2VzcyA9PT0gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgdmFyIHNpbXBsZUV4Y2VwdGlvbkRvbmUgPSBuZXcgRnV0dXJlXHJcbiAgICAgICAgdGhpcy50ZXN0KCdzaW1wbGUgZXhjZXB0aW9uJywgZnVuY3Rpb24odCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvdW50KDQpXHJcbiAgICAgICAgICAgIHZhciB0ZXN0ID0gVW5pdC50ZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb3VudCgxKVxyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lb3V0KDApIC8vIGp1c3QgdG8gbWFrZSB0aGUgdGVzdCBlbmQgZmFzdGVyXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcInN5bmNcIilcclxuICAgICAgICAgICAgfSkuZXZlbnRzKHtcclxuICAgICAgICAgICAgICAgIGVuZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSB0ZXN0LnJlc3VsdHMoKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMubmFtZSA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgIHQub2socmVzdWx0cy5leGNlcHRpb25zLmxlbmd0aCA9PT0gMSwgcmVzdWx0cy5leGNlcHRpb25zLmxlbmd0aClcclxuICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMuZXhjZXB0aW9uc1swXS5tZXNzYWdlID09PSAnc3luYycpXHJcbiAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLnRpbWVvdXQgPT09IHRydWUsIHJlc3VsdHMudGltZW91dClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2ltcGxlRXhjZXB0aW9uRG9uZS5yZXR1cm4oKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHNpbXBsZUV4Y2VwdGlvbkRvbmUudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHNpbXBsZUFzeW5jRXhjZXB0aW9uRnV0dXJlRG9uZSA9IG5ldyBGdXR1cmVcclxuICAgICAgICAgICAgdC50ZXN0KCdzaW1wbGUgYXN5bmMgZXhjZXB0aW9uJywgZnVuY3Rpb24odCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb3VudCg0KVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBzaW1wbGVBc3luY0V4Y2VwdGlvbkZ1dHVyZSA9IG5ldyBGdXR1cmVcclxuICAgICAgICAgICAgICAgIHZhciBzaW1wbGVBc3luY0V4Y2VwdGlvblRlc3QgPSBVbml0LnRlc3QoZnVuY3Rpb24odCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMSlcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vayh0cnVlKSAvLyB0byBwcmV2ZW50IGl0IGZyb20gdGltaW5nIG91dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2ltcGxlQXN5bmNFeGNlcHRpb25GdXR1cmUucmV0dXJuKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJBc3luY1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIDApXHJcbiAgICAgICAgICAgICAgICB9KS5ldmVudHMoe1xyXG4gICAgICAgICAgICAgICAgICAgIGVuZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpbXBsZUFzeW5jRXhjZXB0aW9uRnV0dXJlLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVzdCA9IHNpbXBsZUFzeW5jRXhjZXB0aW9uVGVzdC5yZXN1bHRzKClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHRlc3QubmFtZSA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vayh0ZXN0LmV4Y2VwdGlvbnMubGVuZ3RoID09PSAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGVzdEVudmlyb25tZW50ID09PSAnbm9kZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHRlc3QuZXhjZXB0aW9uc1swXS5tZXNzYWdlID09PSAnQXN5bmMnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXN0LmV4Y2VwdGlvbnNbMF0ubWVzc2FnZS5pbmRleE9mKCdVbmNhdWdodCBlcnJvciBpbicpID09PSAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIHRlc3QuZXhjZXB0aW9uc1swXS5tZXNzYWdlLmluZGV4T2YoJ0Vycm9yOiBBc3luYycpICE9PSAtMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiB0ZXN0LmV4Y2VwdGlvbnNbMF0ubWVzc2FnZS5pbmRleE9mKCdkZWFkdW5pdFRlc3RzLmJyb3dzZXIudW1kLmpzJykgIT09IC0xXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vayh0ZXN0LnRpbWVvdXQgPT09IGZhbHNlKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbXBsZUFzeW5jRXhjZXB0aW9uRnV0dXJlRG9uZS5yZXR1cm4oKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5kb25lKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgIG1vcmVGdXR1cmVzLnB1c2goc2ltcGxlQXN5bmNFeGNlcHRpb25GdXR1cmVEb25lKVxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNpbXBsZUFzeW5jRXhjZXB0aW9uRnV0dXJlRG9uZVxyXG5cclxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGZ1bGxEZWFkdW5pdFRlc3RGdXR1cmUgPSBuZXcgRnV0dXJlXHJcbiAgICAgICAgICAgIHQudGVzdCgnVGVzdGluZyBcIkZ1bGwgZGVhZHVuaXQgdGVzdFwiJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50KDkpXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGZ1dHVyZXNUb1dhaXRPbiA9IFtdXHJcbiAgICAgICAgICAgICAgICB2YXIgdGVzdEdyb3VwcyA9IFVuaXQudGVzdChcIkZ1bGwgZGVhZHVuaXQgdGVzdCAocmVzdWx0cyBvZiB0aGlzIHdpbGwgYmUgdmVyaWZpZWQpXCIsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVvdXQoMjAwMClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KFwiVGVzdCBTb21lIFN0dWZmXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlc3QoXCJhc3NlcnRTb21ldGhpbmdcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKDUgPT09IDUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVzdChcIidzaG91bGRGYWlsJyBmYWlscyBjb3JyZWN0bHlcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKDUgPT09IDMsICdhY3R1YWwnLCAnZXhwZWN0ZWQnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcXVhbCh0cnVlLCBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKFwidGVzdCBsb2dcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KFwic2hvdWxkVGhyb3dFeGNlcHRpb25cIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50KDEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBaGhoaGghXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVzdChcInNob3VsZCB0aHJvdyBhbiBhc3luY2hyb25vdXMgZXhjZXB0aW9uXCIsIGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IG5ldyBGdXR1cmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1dHVyZXNUb1dhaXRPbi5wdXNoKGYpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQub2sodHJ1ZSkgLy8gdG8gcHJldmVudCB0aW1lb3V0ICphbmQqIGFuIGVhcmx5IGVuZGluZyBvZiB0aGUgdGVzdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLnJldHVybigpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcIkFzeW5jaHJvbm91cyBBaGhoaGghXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhcInN1YnRlc3Qgd2l0aG91dCBhIG5hbWVcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCg0KSAvLyA1IGFjdHVhbGx5IGhhcHBlblxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KFwiU3VjY2Vzc2Z1bFRlc3RHcm91cFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KFwieWF5XCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcXVhbCh0cnVlLCB0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVzdChcImxvbmcgYmVmb3JlL2FmdGVyXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWZvcmUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIG49MDsgbjwxMDAwMDAwOyBuKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ICs9IHgrMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KFwib25lXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh4ID09PSBJbmZpbml0eSwgeClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlc3QoXCJhc3luY2hyb25vdXMgZXJyb3JzXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJtb29cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgXCJ0aHJvd24gc3RyaW5nXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwwKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gbmV3IEZ1dHVyZVxyXG4gICAgICAgICAgICAgICAgICAgIGZ1dHVyZXNUb1dhaXRPbi5wdXNoKGYpXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgICAgLy8gd2h5IGlzIHRoaXMgaGVyZT8gUG9zc2libHkgdG8gbWFrZSBzdXJlIHRoZSBcImFzeW5jaHJvbm91cyBlcnJvcnNcIiBmaW5pc2ggZmlyc3Q/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGYucmV0dXJuKClcclxuICAgICAgICAgICAgICAgICAgICB9LDUwKVxyXG4gICAgICAgICAgICAgICAgfSkuZXZlbnRzKHtlbmQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZnV0dXJlc0ZvclRoaXNUZXN0ID0gRnV0dXJlLmFsbChmdXR1cmVzVG9XYWl0T24pXHJcbiAgICAgICAgICAgICAgICAgICAgbW9yZUZ1dHVyZXMucHVzaChmdXR1cmVzRm9yVGhpc1Rlc3QpXHJcbiAgICAgICAgICAgICAgICAgICAgZnV0dXJlc0ZvclRoaXNUZXN0LnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXN0ID0gdGVzdEdyb3Vwcy5yZXN1bHRzKClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2sodGVzdC50aW1lb3V0ID09PSBmYWxzZSwgdGVzdC50aW1lb3V0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHRlc3QudHlwZSA9PT0gXCJncm91cFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHRlc3QubmFtZSA9PT0gXCJGdWxsIGRlYWR1bml0IHRlc3QgKHJlc3VsdHMgb2YgdGhpcyB3aWxsIGJlIHZlcmlmaWVkKVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0ZXN0RW52aXJvbm1lbnQgPT09ICdub2RlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh0ZXN0LmV4Y2VwdGlvbnMubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh0ZXN0LmV4Y2VwdGlvbnMubGVuZ3RoID09PSAzLCB0ZXN0LmV4Y2VwdGlvbnMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh0ZXN0LnJlc3VsdHMubGVuZ3RoID09PSA0LCB0ZXN0LnJlc3VsdHMubGVuZ3RoKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KFwiVmVyaWZ5ICdUZXN0IFNvbWUgU3R1ZmYnXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCg0NilcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VidGVzdDEgPSB0ZXN0LnJlc3VsdHNbMF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDEudHlwZSA9PT0gXCJncm91cFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0MS5uYW1lID09PSBcIlRlc3QgU29tZSBTdHVmZlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0MS5leGNlcHRpb25zLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDEucmVzdWx0cy5sZW5ndGggPT09IDcsIHN1YnRlc3QxLnJlc3VsdHMubGVuZ3RoKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VidGVzdDIgPSBzdWJ0ZXN0MS5yZXN1bHRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0Mi50eXBlID09PSBcImdyb3VwXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0Mi5uYW1lID09PSBcImFzc2VydFNvbWV0aGluZ1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDIuZXhjZXB0aW9ucy5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0Mi5yZXN1bHRzLmxlbmd0aCA9PT0gMSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJ0ZXN0MyA9IHN1YnRlc3QyLnJlc3VsdHNbMF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0My50eXBlID09PSBcImFzc2VydFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QzLnN1Y2Nlc3MgPT09IHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDMuc291cmNlTGluZXMuaW5kZXhPZihcIjUgPT09IDVcIikgIT09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QzLmZpbGUgPT09IHRlc3RGaWxlTmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0My5saW5lID09PSAxMjgsIHN1YnRlc3QzLmxpbmUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5vayhzdWJ0ZXN0My5jb2x1bW4gPT09IDksIHN1YnRlc3QzLmNvbHVtbilcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VidGVzdDIgPSBzdWJ0ZXN0MS5yZXN1bHRzWzFdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0Mi5uYW1lID09PSBcIidzaG91bGRGYWlsJyBmYWlscyBjb3JyZWN0bHlcIiwgc3VidGVzdDIubmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QyLmV4Y2VwdGlvbnMubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDIucmVzdWx0cy5sZW5ndGggPT09IDQsIHN1YnRlc3QyLnJlc3VsdHMubGVuZ3RoKVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnRlc3QzID0gc3VidGVzdDIucmVzdWx0c1swXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QzLnR5cGUgPT09IFwibG9nXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDMudmFsdWVzLmxlbmd0aCA9PT0gMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0My52YWx1ZXNbMF0gPT09IFwidGVzdCBsb2dcIilcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnRlc3QzID0gc3VidGVzdDIucmVzdWx0c1sxXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QzLnN1Y2Nlc3MgPT09IGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QzLnNvdXJjZUxpbmVzLmluZGV4T2YoXCI1ID09PSAzXCIpICE9PSAtMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0My5hY3R1YWwgPT09ICdhY3R1YWwnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QzLmV4cGVjdGVkID09PSAnZXhwZWN0ZWQnKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VidGVzdDMgPSBzdWJ0ZXN0Mi5yZXN1bHRzWzJdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDMuc3VjY2VzcyA9PT0gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDMuc291cmNlTGluZXMuaW5kZXhPZihcInRydWUsIGZhbHNlXCIpICE9PSAtMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0My5maWxlID09PSB0ZXN0RmlsZU5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDMubGluZSA9PT0gMTMyLCBzdWJ0ZXN0My5saW5lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMub2soc3VidGVzdDMuY29sdW1uID09PSA5LCBzdWJ0ZXN0My5jb2x1bW4pXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJ0ZXN0MyA9IHN1YnRlc3QyLnJlc3VsdHNbM10gICAgICAvLyBjb3VudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QzLnR5cGUgPT09IFwiYXNzZXJ0XCIsIHN1YnRlc3QzLnR5cGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDMuc3VjY2VzcyA9PT0gdHJ1ZSwgc3VidGVzdDMuc3VjY2VzcylcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VidGVzdDIgPSBzdWJ0ZXN0MS5yZXN1bHRzWzJdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0Mi5uYW1lID09PSBcInNob3VsZFRocm93RXhjZXB0aW9uXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0Mi5leGNlcHRpb25zLmxlbmd0aCA9PT0gMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QyLmV4Y2VwdGlvbnNbMF0ubWVzc2FnZSA9PT0gXCJBaGhoaGghXCIpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDIucmVzdWx0cy5sZW5ndGggPT09IDIsIHN1YnRlc3QyLnJlc3VsdHMubGVuZ3RoKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VidGVzdDMgPSBzdWJ0ZXN0Mi5yZXN1bHRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDMuc3VjY2VzcyA9PT0gdHJ1ZSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnRlc3QzID0gc3VidGVzdDIucmVzdWx0c1sxXSAgICAgLy8gY291bnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0My5zdWNjZXNzID09PSB0cnVlKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJ0ZXN0MiA9IHN1YnRlc3QxLnJlc3VsdHNbM11cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QyLm5hbWUgPT09IFwic2hvdWxkIHRocm93IGFuIGFzeW5jaHJvbm91cyBleGNlcHRpb25cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0ZXN0RW52aXJvbm1lbnQgPT09ICdub2RlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QyLmV4Y2VwdGlvbnMubGVuZ3RoID09PSAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QyLmV4Y2VwdGlvbnNbMF0ubWVzc2FnZSA9PT0gXCJBc3luY2hyb25vdXMgQWhoaGhoIVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDIuZXhjZXB0aW9ucy5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2sodGVzdC5leGNlcHRpb25zWzBdLm1lc3NhZ2UuaW5kZXhPZignQXN5bmNocm9ub3VzIEFoaGhoaCEnKSAhPT0gLTEpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0Mi5yZXN1bHRzLmxlbmd0aCA9PT0gMiwgc3VidGVzdDIucmVzdWx0cy5sZW5ndGgpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDEucmVzdWx0c1s0XS50eXBlID09PSAnbG9nJywgc3VidGVzdDEucmVzdWx0c1s0XS50eXBlKSAvLyBsb2dcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QxLnJlc3VsdHNbNF0udmFsdWVzWzBdID09PSAnc3VidGVzdCB3aXRob3V0IGEgbmFtZScpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnRlc3QyID0gc3VidGVzdDEucmVzdWx0c1s1XVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDIubmFtZSA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDIuZXhjZXB0aW9ucy5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0Mi5yZXN1bHRzLmxlbmd0aCA9PT0gMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QyLnJlc3VsdHNbMF0uc3VjY2VzcyA9PT0gdHJ1ZSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VidGVzdDIgPSBzdWJ0ZXN0MS5yZXN1bHRzWzZdICAgICAvLyBjb3VudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDIuc3VjY2VzcyA9PT0gZmFsc2UsIHN1YnRlc3QyLnN1Y2Nlc3MpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlc3QoXCJWZXJpZnkgJ1N1Y2Nlc3NmdWxUZXN0R3JvdXAnXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCg4KVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJ0ZXN0MSA9IHRlc3QucmVzdWx0c1sxXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0MS5uYW1lID09PSBcIlN1Y2Nlc3NmdWxUZXN0R3JvdXBcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDEuZXhjZXB0aW9ucy5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QxLnJlc3VsdHMubGVuZ3RoID09PSAxKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJ0ZXN0MiA9IHN1YnRlc3QxLnJlc3VsdHNbMF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDIubmFtZSA9PT0gXCJ5YXlcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDIuZXhjZXB0aW9ucy5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QyLnJlc3VsdHMubGVuZ3RoID09PSAxKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJ0ZXN0MyA9IHN1YnRlc3QyLnJlc3VsdHNbMF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDMuc3VjY2VzcyA9PT0gdHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDMuc291cmNlTGluZXMuaW5kZXhPZihcInRydWVcIikgIT09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KFwiVmVyaWZ5ICdsb25nIGJlZm9yZS9hZnRlcidcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50KDUpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnRlc3QxID0gdGVzdC5yZXN1bHRzWzJdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QxLm5hbWUgPT09IFwibG9uZyBiZWZvcmUvYWZ0ZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDEuZXhjZXB0aW9ucy5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QxLnJlc3VsdHMubGVuZ3RoID09PSAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0MS5yZXN1bHRzWzBdLm5hbWUgPT09ICdvbmUnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0MS5yZXN1bHRzWzBdLnJlc3VsdHNbMF0uc3VjY2VzcyA9PT0gdHJ1ZSwgc3VidGVzdDEucmVzdWx0c1swXS5maWxlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KFwiVmVyaWZ5ICdhc3luY2hyb25vdXMgZXJyb3JzJ1wiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnQoNSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VidGVzdDEgPSB0ZXN0LnJlc3VsdHNbM11cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDEubmFtZSA9PT0gXCJhc3luY2hyb25vdXMgZXJyb3JzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QxLnJlc3VsdHMubGVuZ3RoID09PSAwKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRlc3RFbnZpcm9ubWVudCA9PT0gJ25vZGUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0MS5leGNlcHRpb25zLmxlbmd0aCA9PT0gMilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHN1YnRlc3QxLmV4Y2VwdGlvbnNbMF0ubWVzc2FnZSA9PT0gJ21vbycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhzdWJ0ZXN0MS5leGNlcHRpb25zWzFdID09PSAndGhyb3duIHN0cmluZycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2soc3VidGVzdDEuZXhjZXB0aW9ucy5sZW5ndGggPT09IDApXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2sodGVzdC5leGNlcHRpb25zWzFdLm1lc3NhZ2UuaW5kZXhPZignbW9vJykgIT09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2sodGVzdC5leGNlcHRpb25zWzJdLm1lc3NhZ2UuaW5kZXhPZigndGhyb3duIHN0cmluZycpICE9PSAtMSkgLy8gaW4gdGhlIGJyb3dzZXIsIGFzeW5jIGVycm9ycyBhcmUgY29udmVydGVkIHRvIHRoZSBzdHVwaWQgb25lcnJvciBmb3JtYXQsIGFuZCBzbyBkZWFkdW5pdCBtYWtlcyB0aGVtIGFsbCBFcnJvciBvYmplY3RzIGFmdGVyIHRoYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdWxsRGVhZHVuaXRUZXN0RnV0dXJlLnJldHVybigpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSkuZG9uZSgpXHJcblxyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpfSlcclxuXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZnVsbERlYWR1bml0VGVzdEZ1dHVyZVxyXG5cclxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgLy8qXHJcbiAgICAgICAgICAgIHQudGVzdChcImJlZm9yZXMgYW5kIGFmdGVyc1wiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciB4ID0gMFxyXG4gICAgICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzXHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5iZWZvcmUoZnVuY3Rpb24odGhhdDIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHRoaXMgPT09IHRoYXQpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh0aGlzID09PSB0aGF0MilcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhcImJlZm9yZTogXCIreClcclxuICAgICAgICAgICAgICAgICAgICB4KytcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFmdGVyKGZ1bmN0aW9uKHRoYXQyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh0aGlzID09PSB0aGF0KVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2sodGhpcyA9PT0gdGhhdDIpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coXCJhZnRlcjogXCIreClcclxuICAgICAgICAgICAgICAgICAgICB4Kz0xMFxyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRlc3QoXCJvbmVcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coXCJ4IGlzOiBcIit4KVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2soeD09PTEsIHgpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgdGhpcy50ZXN0KFwidHdvXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2soeD09PTEyLCB4KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHQudGVzdChcIkFzeW5jaHJvbm91cyB0aW1lc1wiLCBmdW5jdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICB0LmNvdW50KDcpXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGYxID0gbmV3IEZ1dHVyZSwgZjIgPSBuZXcgRnV0dXJlLCBmMyA9IG5ldyBGdXR1cmVcclxuICAgICAgICAgICAgICAgIG1vcmVGdXR1cmVzLnB1c2goZjMpXHJcbiAgICAgICAgICAgICAgICB2YXIgdGVzdCA9IFVuaXQudGVzdChmdW5jdGlvbih0ZXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCgyKVxyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlc3Qub2sodHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgZjEucmV0dXJuKClcclxuICAgICAgICAgICAgICAgICAgICB9LCAxMDApXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KGZ1bmN0aW9uKHN1YnRlc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCgxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VidGVzdC5vayh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZjIucmV0dXJuKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMjAwKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9KS5ldmVudHMoe2VuZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgRnV0dXJlLmFsbChbZjEsZjJdKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHRlc3QucmVzdWx0cygpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMudGltZW91dCA9PT0gZmFsc2UsIHJlc3VsdHMudGltZW91dClcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLmR1cmF0aW9uID49IDIwMCwgcmVzdWx0cy5kdXJhdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLnJlc3VsdHMubGVuZ3RoID09PSAzLCByZXN1bHRzLnJlc3VsdHMubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMucmVzdWx0c1swXS5yZXN1bHRzLmxlbmd0aCA9PT0gMilcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLnJlc3VsdHNbMF0ucmVzdWx0c1swXS5zdWNjZXNzID09PSB0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMucmVzdWx0c1swXS5kdXJhdGlvbiA+PSAyMDAsIHJlcXVpcmUoJ3V0aWwnKS5pbnNwZWN0KHJlc3VsdHMucmVzdWx0c1swXSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQub2socmVzdWx0cy5yZXN1bHRzWzFdLnN1Y2Nlc3MgPT09IHRydWUpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5vayhmYWxzZSwgZSlcclxuICAgICAgICAgICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmMy5yZXR1cm4oKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmRvbmUoKVxyXG4gICAgICAgICAgICAgICAgfX0pXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiB0ZXN0Q291bnRzKHQsIHRlc3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gdGVzdC5yZXN1bHRzKClcclxuXHJcbiAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMucmVzdWx0cy5sZW5ndGggPT09IDMsIHJlc3VsdHMucmVzdWx0cy5sZW5ndGgpXHJcbiAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMucmVzdWx0c1syXS5hY3R1YWwgPT09IDIgJiYgcmVzdWx0cy5yZXN1bHRzWzJdLnN1Y2Nlc3MgPT09IHRydWUsIHJlcXVpcmUoJ3V0aWwnKS5pbnNwZWN0KHJlc3VsdHMucmVzdWx0c1syXSkpXHJcbiAgICAgICAgICAgICAgICB2YXIgc3VidGVzdDEgPSByZXN1bHRzLnJlc3VsdHNbMF1cclxuICAgICAgICAgICAgICAgIHQub2soc3VidGVzdDEucmVzdWx0c1syXS5hY3R1YWwgPT09IDIgJiYgc3VidGVzdDEucmVzdWx0c1syXS5zdWNjZXNzID09PSB0cnVlLCByZXF1aXJlKCd1dGlsJykuaW5zcGVjdChzdWJ0ZXN0MS5yZXN1bHRzWzJdKSlcclxuICAgICAgICAgICAgICAgIHQub2soc3VidGVzdDEucmVzdWx0cy5sZW5ndGggPT09IDMsIHN1YnRlc3QxLnJlc3VsdHMubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgdmFyIHN1YnRlc3QyID0gc3VidGVzdDEucmVzdWx0c1swXVxyXG4gICAgICAgICAgICAgICAgdC5vayhzdWJ0ZXN0Mi5yZXN1bHRzLmxlbmd0aCA9PT0gMiwgc3VidGVzdDIucmVzdWx0cy5sZW5ndGgpXHJcbiAgICAgICAgICAgICAgICB0Lm9rKHN1YnRlc3QyLnJlc3VsdHNbMV0uYWN0dWFsID09PSAxXHJcbiAgICAgICAgICAgICAgICAgICAgJiYgc3VidGVzdDIucmVzdWx0c1sxXS5zdWNjZXNzID09PSB0cnVlLCByZXF1aXJlKCd1dGlsJykuaW5zcGVjdChzdWJ0ZXN0Mi5yZXN1bHRzWzFdKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdC50ZXN0KFwiY291bnRzXCIsIGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnQoNilcclxuICAgICAgICAgICAgICAgIHZhciB0ZXN0ID0gVW5pdC50ZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMilcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlc3QoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMilcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCgxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHRydWUpXHJcbiAgICAgICAgICAgICAgICB9KS5ldmVudHMoe2VuZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVzdENvdW50cyh0LCB0ZXN0KVxyXG4gICAgICAgICAgICAgICAgfX0pXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICB0LnRlc3QoXCJhc3luY2hyb25vdXMgY291bnRzXCIsIGZ1bmN0aW9uKHRlc3Rlcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSBuZXcgRnV0dXJlLCBkb25lID0gbmV3IEZ1dHVyZVxyXG4gICAgICAgICAgICAgICAgdmFyIG9uZSA9IG5ldyBGdXR1cmUsIHR3byA9IG5ldyBGdXR1cmUgLy8gc2V0VGltZW91dCBhcHBhcmVudGx5IGlzbid0IGRldGVybWluaXN0aWMgaW4gbm9kZS5qcyAod2hpY2ggc3Vja3MpLCBzbyB1c2luZyBmdXR1cmVzIGluc3RlYWQgdG8gZ3VhcmFudGVlIG9yZGVyXHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb3VudCg2KVxyXG4gICAgICAgICAgICAgICAgbW9yZUZ1dHVyZXMucHVzaChkb25lKVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0ZXN0ID0gVW5pdC50ZXN0KGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmNvdW50KDIpXHJcbiAgICAgICAgICAgICAgICAgICAgdC50ZXN0KGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5jb3VudCgyKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnRlc3QoZnVuY3Rpb24odCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5jb3VudCgxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHdvLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vayh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYucmV0dXJuKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uZS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vayh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHdvLnJldHVybigpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uZS5yZXR1cm4oKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sMClcclxuICAgICAgICAgICAgICAgIH0pLmV2ZW50cyh7ZW5kOiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgIGYudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVzdENvdW50cyh0ZXN0ZXIsIHRlc3QpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lLnJldHVybigpXHJcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXN0ZXIub2soZmFsc2UsIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSkuZG9uZSgpXHJcbiAgICAgICAgICAgICAgICB9fSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHQudGVzdChcInRpbWVvdXRzXCIsIGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMSlcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGVzdCA9IFVuaXQudGVzdChmdW5jdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lb3V0KDUwMClcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlc3QoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMSkgLy8gdG8gbWFrZSBpdCB0aW1lb3V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZW91dCg1MClcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSkuZXZlbnRzKHtlbmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gdGVzdC5yZXN1bHRzKClcclxuICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMuZHVyYXRpb24gPj0gNTAwLCByZXN1bHRzLmR1cmF0aW9uKVxyXG4gICAgICAgICAgICAgICAgfX0pXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICB2YXIgdW5oYW5kbGVkRXJyb3JIYW5kbGVyRnV0dXJlID0gbmV3IEZ1dHVyZVxyXG4gICAgICAgICAgICB0LnRlc3QoJ3VuaGFuZGxlZCBlcnJvciBoYW5kbGVyJywgZnVuY3Rpb24ocmVhbHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnQoNylcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3JDb3VudCA9IDBcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGVzdCA9IFVuaXQudGVzdChmdW5jdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCgxKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JDb3VudCsrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVycm9yQ291bnQgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWx0Lm9rKGUubWVzc2FnZSA9PT0gJ3N5bmNocm9ub3VzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGVycm9yQ291bnQgPT09IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRlc3RFbnZpcm9ubWVudCA9PT0gJ25vZGUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbHQub2soZS5tZXNzYWdlID09PSAndGVzdCcsIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWx0Lm9rKGUubWVzc2FnZS5pbmRleE9mKCdFcnJvcjogdGVzdCcpICE9PSAtMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihlcnJvckNvdW50ID09PSAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0ZXN0RW52aXJvbm1lbnQgPT09ICdub2RlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWx0Lm9rKGUgPT09ICd0aHJvd24gc3RyaW5nJywgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbHQub2soZS5tZXNzYWdlLmluZGV4T2YoJ3VuY2F1Z2h0IGV4Y2VwdGlvbjogdGhyb3duIHN0cmluZycpICE9PSAtMSwgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGVycm9yQ291bnQgPT09IDQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZXJyb3IgaW5zaWRlIGVycm9yIGhhbmRsZXInKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbHQub2soZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Rlc3QnKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sMClcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBcInRocm93biBzdHJpbmdcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sMClcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ09uZSBtb3JlJylcclxuICAgICAgICAgICAgICAgICAgICB9LDApXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5vayh0cnVlKSAvLyBoZXJlIHRvIG1ha2Ugc3VyZSBhbGwgdGhlIGV4Y2VwdGlvbnMgYXJlIHdhaXRlZCBmb3JcclxuICAgICAgICAgICAgICAgICAgICB9LDApXHJcbiAgICAgICAgICAgICAgICAgICAgdW5oYW5kbGVkRXJyb3JIYW5kbGVyRnV0dXJlLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IodW5kZWZpbmVkKSAvLyBnZXQgcmlkIG9mIGVycm9yIGhhbmRsZXIgb25jZSB0ZXN0IGlzIGRvbmVcclxuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInN5bmNocm9ub3VzXCIpXHJcblxyXG4gICAgICAgICAgICAgICAgfSkuZXZlbnRzKHtlbmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gdGVzdC5yZXN1bHRzKClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVhbHQub2socmVzdWx0cy5uYW1lID09PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVhbHQub2socmVzdWx0cy5yZXN1bHRzLmxlbmd0aCA9PT0gMiwgcmVzdWx0cy5yZXN1bHRzKVxyXG4gICAgICAgICAgICAgICAgICAgIHJlYWx0Lm9rKHJlc3VsdHMuZXhjZXB0aW9ucy5sZW5ndGggPT09IDEsIHJlc3VsdHMuZXhjZXB0aW9ucylcclxuICAgICAgICAgICAgICAgICAgICByZWFsdC5vayhyZXN1bHRzLmV4Y2VwdGlvbnNbMF0ubWVzc2FnZSA9PT0gJ2Vycm9yIGluc2lkZSBlcnJvciBoYW5kbGVyJylcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdW5oYW5kbGVkRXJyb3JIYW5kbGVyRnV0dXJlLnJldHVybigpXHJcbiAgICAgICAgICAgICAgICB9fSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1bmhhbmRsZWRFcnJvckhhbmRsZXJGdXR1cmVcclxuXHJcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAvLypcclxuICAgICAgICAgICAgdmFyIGxvZ3NGdXR1cmUgPSBuZXcgRnV0dXJlXHJcbiAgICAgICAgICAgIHQudGVzdCgnbG9ncycsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBhcnJheSA9IFsxLCdhJyx7YTonYicsIGI6WzEsMl19XVxyXG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IHtzb21lOiAnb2JqZWN0J31cclxuICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IEVycm9yKCd0ZXN0JylcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGVzdCA9IFVuaXQudGVzdChmdW5jdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhvYmplY3QpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coYXJyYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coZXJyb3IpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coXCJzdHJpbmdcIiwgb2JqZWN0LCBhcnJheSwgZXJyb3IpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2soZmFsc2UsIFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhmYWxzZSwgb2JqZWN0KVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2soZmFsc2UsIGFycmF5KVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2soZmFsc2UsIGVycm9yKVxyXG5cclxuICAgICAgICAgICAgICAgIH0pLmV2ZW50cyh7ZW5kOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHRlc3QucmVzdWx0cygpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2socmVzdWx0cy5leGNlcHRpb25zLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHJlc3VsdHMucmVzdWx0cy5sZW5ndGggPT09IDkpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhyZXN1bHRzLnJlc3VsdHNbMF0udmFsdWVzLmxlbmd0aCA9PT0gMSlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHJlc3VsdHMucmVzdWx0c1swXS52YWx1ZXNbMF0gPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhyZXN1bHRzLnJlc3VsdHNbMV0udmFsdWVzLmxlbmd0aCA9PT0gMSlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHJlc3VsdHMucmVzdWx0c1sxXS52YWx1ZXNbMF0gPT09IG9iamVjdCwgcmVzdWx0cy5yZXN1bHRzWzFdLnZhbHVlcylcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHJlc3VsdHMucmVzdWx0c1syXS52YWx1ZXMubGVuZ3RoID09PSAxKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2socmVzdWx0cy5yZXN1bHRzWzJdLnZhbHVlc1swXSA9PT0gYXJyYXksIHJlc3VsdHMucmVzdWx0c1syXS52YWx1ZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhyZXN1bHRzLnJlc3VsdHNbM10udmFsdWVzLmxlbmd0aCA9PT0gMSlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHJlc3VsdHMucmVzdWx0c1szXS52YWx1ZXNbMF0gPT09IGVycm9yLCByZXN1bHRzLnJlc3VsdHNbM10udmFsdWVzKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2socmVzdWx0cy5yZXN1bHRzWzRdLnZhbHVlcy5sZW5ndGggPT09IDQpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhyZXN1bHRzLnJlc3VsdHNbNF0udmFsdWVzWzBdID09PSBcInN0cmluZ1wiLCByZXN1bHRzLnJlc3VsdHNbNF0udmFsdWVzWzBdKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2socmVzdWx0cy5yZXN1bHRzWzRdLnZhbHVlc1sxXSA9PT0gb2JqZWN0LCByZXN1bHRzLnJlc3VsdHNbNF0udmFsdWVzWzFdKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2socmVzdWx0cy5yZXN1bHRzWzRdLnZhbHVlc1syXSA9PT0gYXJyYXksIHJlc3VsdHMucmVzdWx0c1s0XS52YWx1ZXNbMl0pXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhyZXN1bHRzLnJlc3VsdHNbNF0udmFsdWVzWzNdID09PSBlcnJvciwgcmVzdWx0cy5yZXN1bHRzWzRdLnZhbHVlc1szXSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhyZXN1bHRzLnJlc3VsdHNbNV0uYWN0dWFsID09PSBcInN0cmluZ1wiLCByZXN1bHRzLnJlc3VsdHNbNV0uYWN0dWFsKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2socmVzdWx0cy5yZXN1bHRzWzZdLmFjdHVhbCA9PT0gb2JqZWN0LCByZXN1bHRzLnJlc3VsdHNbNl0uYWN0dWFsKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2socmVzdWx0cy5yZXN1bHRzWzddLmFjdHVhbCA9PT0gYXJyYXksIHJlc3VsdHMucmVzdWx0c1s3XS5hY3R1YWwpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhyZXN1bHRzLnJlc3VsdHNbOF0uYWN0dWFsID09PSBlcnJvciwgcmVzdWx0cy5yZXN1bHRzWzhdLmFjdHVhbClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbG9nc0Z1dHVyZS5yZXR1cm4oKVxyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpfSlcclxuXHJcblxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGxvZ3NGdXR1cmVcclxuXHJcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgICAgdC50ZXN0KCdldmVudCBzdHJlYW0nLCBmdW5jdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50KDkpXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGRvbmUgPSBuZXcgRnV0dXJlXHJcbiAgICAgICAgICAgICAgICBtb3JlRnV0dXJlcy5wdXNoKGRvbmUpXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwU2VxdWVuY2UgPSBzZXF1ZW5jZSgpXHJcbiAgICAgICAgICAgICAgICB2YXIgYXNzZXJ0U2VxdWVuY2UgPSBzZXF1ZW5jZSgpXHJcbiAgICAgICAgICAgICAgICB2YXIgY291bnRTZXF1ZW5jZSA9IHNlcXVlbmNlKClcclxuICAgICAgICAgICAgICAgIHZhciBsb2dTZXF1ZW5jZSA9IHNlcXVlbmNlKClcclxuICAgICAgICAgICAgICAgIHZhciBlbmRTZXF1ZW5jZSA9IHNlcXVlbmNlKClcclxuXHJcbiAgICAgICAgICAgICAgICBVbml0LnRlc3QoJ29uZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhmYWxzZSwgXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKHRydWUpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVzdCgndHdvJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9KS5ldmVudHMoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cDogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBTZXF1ZW5jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKGUubmFtZSA9PT0gJ29uZScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQub2soZS5uYW1lID09PSAndHdvJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydDogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0U2VxdWVuY2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vayhlLnN1Y2Nlc3MgPT09IGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKGUuc3VjY2VzcyA9PT0gdHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vayhlLnN1Y2Nlc3MgPT09IHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudDogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRTZXF1ZW5jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKGUuc3VjY2VzcyA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQub2soZS5zb3VyY2VMaW5lcyA9PT0gJ3RoaXMuY291bnQoMSknLCBlLnNvdXJjZUxpbmVzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dTZXF1ZW5jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKGUudmFsdWVzWzBdID09PSBcInN0cmluZ1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lLnJldHVybigpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRTZXF1ZW5jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKGUudHlwZSA9PT0gJ25vcm1hbCcsIGUudHlwZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgdC50ZXN0KCdldmVudCBzdHJlYW0gdGltZW91dCcsIGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMSlcclxuICAgICAgICAgICAgICAgIHZhciBkb25lID0gbmV3IEZ1dHVyZVxyXG4gICAgICAgICAgICAgICAgbW9yZUZ1dHVyZXMucHVzaChkb25lKVxyXG4gICAgICAgICAgICAgICAgdmFyIGVuZFNlcXVlbmNlID0gc2VxdWVuY2UoKVxyXG5cclxuICAgICAgICAgICAgICAgIFVuaXQudGVzdChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50KDEpIC8vIHdhaXRpbmcgZm9yIDEgYXNzZXJ0IHRoYXQgd2lsbCBuZXZlciBjb21lXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lb3V0KDEwKVxyXG4gICAgICAgICAgICAgICAgfSkuZXZlbnRzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lLnJldHVybigpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRTZXF1ZW5jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKGUudHlwZSA9PT0gJ3RpbWVvdXQnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICB0LnRlc3QoJ2V2ZW50IHN0cmVhbSBuZXN0ZWQgY2FsbCcsIGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMSlcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdW5pdHRlc3QgPSBVbml0LnRlc3QoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCgxKSAvLyB3YWl0aW5nIGZvciAxIGFzc2VydCB0aGF0IHdpbGwgbmV2ZXIgY29tZVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGltZW91dCgxMClcclxuICAgICAgICAgICAgICAgIH0pLmV2ZW50cyh7XHJcbiAgICAgICAgICAgICAgICAgICAgZW5kOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXR0ZXN0LmV2ZW50cyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQub2sodHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgdC50ZXN0KCdzb3VyY2VtYXAnLCBmdW5jdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdW5pdHRlc3QgPSBVbml0LnRlc3QoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vayh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVzdCgnY29mZmVlc2NyaXB0IGZpbGUnLCBnbG9iYWwuc291cmNlTWFwVGVzdClcclxuXHJcbiAgICAgICAgICAgICAgICB9KS5ldmVudHMoe1xyXG4gICAgICAgICAgICAgICAgICAgIGVuZDogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHVuaXR0ZXN0LnJlc3VsdHMoKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG9kbzogdGhlIG9yZGVyIG9mIHRoZXNlIHNob3VsZCBzd2ljaCwgYnV0IGkgZG9uJ3Qgd2FubmEgZGVhbCB3aXRoIGl0IHJpZ2h0IG5vdyAoaWUgZml4IHRoZSBwcm9ibGVtIGluIGRlYWR1bml0IHRoYXQncyBjYXVzaW5nIGVhcmxpZXIgYXNzZXJ0IHRvIGJlIGVtaXR0ZWQgYWZ0ZXIgbGF0ZXIgc3VidGVzdHMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQub2socmVzdWx0cy5yZXN1bHRzWzBdLnJlc3VsdHNbMV0ubGluZSA9PT0gMilcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLnJlc3VsdHNbMF0ucmVzdWx0c1swXS5saW5lID09PSA3KSAvLyBpbiB0aGUgb3JpZ2luYWwgc291cmNlIGl0J3MgNiwgdGhpcyB0ZXN0cyB0dXJuaW5nIG9mZiBzb3VyY2UgbWFwIHByaW50aW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQub2socmVzdWx0cy5yZXN1bHRzWzBdLmV4Y2VwdGlvbnMubGVuZ3RoID09PSAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMucmVzdWx0c1swXS5leGNlcHRpb25zWzBdID09PSAnbW9vc2UnLCByZXN1bHRzLnJlc3VsdHNbMF0uZXhjZXB0aW9uc1swXSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQub2socmVzdWx0cy5yZXN1bHRzWzFdLmxpbmUgPT09IDc0NSkgLy8gbm90ZSB0aGF0IHRoaXMgdGVzdHMgdG8gbWFrZSBzdXJlIHNvdXJjZW1hcHMgd29yayB3aXRoIGlubGluZS1zb3VyY2VtYXBzIChhdCBsZWFzdCB0aGUgYmFzZTY0IGVuY29kZWQga2luZCBicm93c2VyaWZ5IGNyZWF0ZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHQudGVzdCgnZm9ybWVyIGJ1Z3MnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMilcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRlc3QoJ2RlYWR1bml0IHdvdWxkIGNyYXNoIGlmIGFuIGFzeW5jaHJvbm91cyBlcnJvciB3YXMgdGhyb3duIGluIHRoZSB0b3AtbGV2ZWwgbWFpbiB0ZXN0JywgZnVuY3Rpb24odCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnQoMilcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVuaXR0ZXN0ID0gVW5pdC50ZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50KDEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZW91dCgxMDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcIkRvbid0IGJyZWFrIVwiKSAgLy8gdGVzdHMgYSBmb3JtZXIgYnVnIHdoZXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDApXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB1bml0dGVzdC5ldmVudHMoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gdW5pdHRlc3QucmVzdWx0cygpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLmV4Y2VwdGlvbnMubGVuZ3RoID09PSAxLCByZXN1bHRzLmV4Y2VwdGlvbnMubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGVzdEVudmlyb25tZW50ID09PSAnbm9kZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMuZXhjZXB0aW9uc1swXS5tZXNzYWdlID09PSBcIkRvbid0IGJyZWFrIVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMuZXhjZXB0aW9uc1swXS5tZXNzYWdlLmluZGV4T2YoXCJEb24ndCBicmVhayFcIikgIT09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy50ZXN0KCdtdWx0aS1saW5lIGFzc2VydHMnLCBmdW5jdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCgzKVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1bml0dGVzdCA9IFVuaXQudGVzdChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vayhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiKVwiID09PSBcIilcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB1bml0dGVzdC5ldmVudHMoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gdW5pdHRlc3QucmVzdWx0cygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlTGluZXMgPSByZXN1bHRzLnJlc3VsdHNbMF0uc291cmNlTGluZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcXVhc2hlZFNvdXJjZUxpbmVzID0gc291cmNlTGluZXMucmVwbGFjZSgvIC9nLCAnJylcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHNxdWFzaGVkU291cmNlTGluZXMgPT09IFwidGhpcy5vayhcXG50cnVlXFxuKVwiLCBzcXVhc2hlZFNvdXJjZUxpbmVzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vayhyZXN1bHRzLnJlc3VsdHNbMV0uc291cmNlTGluZXMucmVwbGFjZSgvIC9nLCAnJykgPT09IFwidGhpcy5vayhcXG4odHJ1ZSlcXG4pXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm9rKHJlc3VsdHMucmVzdWx0c1syXS5zb3VyY2VMaW5lcy5yZXBsYWNlKC8gL2csICcnKSA9PT0gJ3RoaXMub2soXFxuXCIpXCI9PT1cIilcIlxcbiknLCByZXN1bHRzLnJlc3VsdHNbMl0uc291cmNlTGluZXMucmVwbGFjZSgvIC9nLCAnJykpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8qL1xyXG5cclxuICAgICAgICAgICAgRnV0dXJlLmFsbChtb3JlRnV0dXJlcykudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlzRG9uZS5yZXR1cm4oKVxyXG4gICAgICAgICAgICB9KS5kb25lKClcclxuXHJcbiAgICAgICAgfSkuZG9uZSgpXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxuXHJcbi8vIHJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGNhbGxzIGEgZGlmZmVyZW50IGZ1bmN0aW9uIGV2ZXJ5IHRpbWVcclxuLy8gd2hlbiBpdCBydW5zIG91dCBvZiBmdW5jdGlvbnMsIGl0IGVycm9yc1xyXG5mdW5jdGlvbiBzZXF1ZW5jZSgpIHtcclxuICAgIHZhciBuID0gMFxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBmbnMgPSBhcmd1bWVudHNcclxuICAgICAgICBuKytcclxuICAgICAgICBpZihuLTEgPj0gZm5zLmxlbmd0aCkgdGhyb3cgRXJyb3IoXCJVbmV4cGVjdGVkIGNhbGwgXCIrbilcclxuICAgICAgICBmbnNbbi0xXSgpXHJcblxyXG4gICAgfVxyXG59XG59KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KSJdfQ==